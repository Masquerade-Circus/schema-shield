(()=>{var e=class extends Error{message;item;keyword;cause;schemaPath="";instancePath="";data;schema;_getCause(t="#",i="#"){let r=`${t}/${this.keyword}`,n=`${i}`;return void 0!==this.item&&("string"==typeof this.item&&this.item in this.schema&&(r+=`/${this.item}`),n+=`/${this.item}`),this.instancePath=n,this.schemaPath=r,this.cause&&this.cause instanceof e?this.cause._getCause(r,n):this}getCause(){return this._getCause()}_getTree(){const e={message:this.message,keyword:this.keyword,item:this.item,schemaPath:this.schemaPath,instancePath:this.instancePath,data:this.data};return this.cause&&(e.cause=this.cause._getTree()),e}getTree(){return this.getCause(),this._getTree()}getPath(){const e=this.getCause();return{schemaPath:e.schemaPath,instancePath:e.instancePath}}},t=()=>!0;function i(i,r,n){if(n)return t;const a=new e(`Invalid ${i}`);a.keyword=i,a.schema=r;return o(`defineError_${i}`,(e,t={})=>(a.message=e,a.item=t.item,a.cause=t.cause&&!0!==t.cause?t.cause:void 0,a.data=t.data,a))}function r(e,t){if(Array.isArray(e)){if(!1===Array.isArray(t))return!0;if(e.length!==t.length)return!0;for(let i=0;i<t.length;i++)if(r(e[i],t[i]))return!0;return!1}if("object"==typeof e&&null!==e){if("object"!=typeof t||null===t)return!0;for(const i in t)if(r(e[i],t[i]))return!0;for(const i in e)if(r(e[i],t[i]))return!0;return!1}return!1===Object.is(e,t)}function n(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function a(e,t=!1,i=new WeakMap){if(null==e||"object"!=typeof e)return e;if(i.has(e))return i.get(e);let r;if("function"==typeof structuredClone)return r=structuredClone(e),i.set(e,r),r;switch(!0){case Array.isArray(e):r=[],i.set(e,r);for(let n=0,s=e.length;n<s;n++)r[n]=a(e[n],t,i);return r;case e instanceof Date:return r=new Date(e.getTime()),i.set(e,r),r;case e instanceof RegExp:return r=new RegExp(e.source,e.flags),i.set(e,r),r;case e instanceof Map:r=new Map,i.set(e,r);for(const[n,s]of e.entries())r.set(a(n,t,i),a(s,t,i));return r;case e instanceof Set:r=new Set,i.set(e,r);for(const n of e.values())r.add(a(n,t,i));return r;case e instanceof ArrayBuffer:return r=e.slice(0),i.set(e,r),r;case ArrayBuffer.isView(e):return r=new e.constructor(e.buffer.slice(0)),i.set(e,r),r;case"undefined"!=typeof Buffer&&e instanceof Buffer:return r=Buffer.from(e),i.set(e,r),r;case e instanceof Error:r=new e.constructor(e.message),i.set(e,r);break;case e instanceof Promise||e instanceof WeakMap||e instanceof WeakSet:return r=e,i.set(e,r),r;case e.constructor&&e.constructor!==Object:if(!t)return r=e,i.set(e,r),r;r=Object.create(Object.getPrototypeOf(e)),i.set(e,r);break;default:{r={},i.set(e,r);const n=Reflect.ownKeys(e);for(let s=0,o=n.length;s<o;s++){const o=n[s];r[o]=a(e[o],t,i)}return r}}const n=Object.getOwnPropertyDescriptors(e);for(const e of Reflect.ownKeys(n)){const s=n[e];"value"in s&&(s.value=a(s.value,t,i)),Object.defineProperty(r,e,s)}return r}function s(e){return n(e)&&"$validate"in e}function o(e,t){return Object.defineProperty(t,"name",{value:e})}var f=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,l=/^P(?!$)((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?$/,u=/^(\d{4})-(0[0-9]|1[0-2])-(\d{2})T(0[0-9]|1\d|2[0-3]):([0-5]\d):((?:[0-5]\d|60))(?:.\d+)?(?:([+-])(0[0-9]|1\d|2[0-3]):([0-5]\d)|Z)?$/i,d=/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,c=/^(?!\.)(?!.*\.$)[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,20}(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,21}){0,2}@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,60}[a-z0-9])?){0,3}$/i,m=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])$/,p=/(?:\s+|:::+|^\w{5,}|\w{5}$|^:{1}\w|\w:{1}$)/,h=/^[0-9a-fA-F:.]*$/,y=/^(?:(?:[0-9a-fA-F]{1,4}:){7}(?:[0-9a-fA-F]{1,4}|:))$/,v=/(?:[0-9a-fA-F]{5,}|\D[0-9a-fA-F]{3}:)/,g=/^(?:(?:(?:[0-9a-fA-F]{1,4}(?::|$)){1,6}))|(?:::(?:[0-9a-fA-F]{1,4})){0,5}$/,b=/^[a-z0-9][a-z0-9-]{0,62}(?:\.[a-z0-9][a-z0-9-]{0,62})*[a-z0-9]$/i,$=/^(\d{4})-(\d{2})-(\d{2})$/,A=/^\/(?:[^~]|~0|~1)*$/,O=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/,w=/^([01]\d|2[0-3]):([0-5]\d):([0-5]\d)(\.\d+)?(Z|([+-])([01]\d|2[0-3]):([0-5]\d))$/,x=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#((?![^#]*\\)[^#]*))?/i,P=/^(?:[^{}]|\{[^}]+\})*$/,j=/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,_=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#((?![^#]*\\)[^#]*))?/i,k=/^[^@\s]+@[^@\s]+\.[^@\s]+$/,V=/^[^\s!@#$%^&*()_+\=\[\]{};':"\\|,<>\/?]+$/,R=/\\/,S=[31,28,31,30,31,30,31,31,30,31,30,31],M={"date-time"(e){const t=e.match(u);if(!t)return!1;const[,i,r,n,a,s,o]=t,f=Number(i),l=Number(r),d=Number(n),c=Number(a),m=Number(s),p=Number(o);if(l<1||l>12)return!1;if(d<1)return!1;const h=2===l?f%4!=0||f%100==0&&f%400!=0?28:29:S[l-1];return!(!h||d>h)&&(60!==p||59===m&&23===c)},uri:e=>d.test(e),email:e=>c.test(e),ipv4:e=>m.test(e),ipv6(e){if("::"===e)return!0;if(-1===e.indexOf(":")||p.test(e))return!1;const t=-1!==e.indexOf(".");let i=e;if(t){i=e.split(":");const t=i.pop();if(!m.test(t))return!1}const r=-1!==e.indexOf("::"),n=t?i.join(":"):e;if(r)return!(n.split("::").length-1>1)&&(!!h.test(n)&&g.test(n));const a=y.test(n),s=v.test(n);return t?a||!s:a&&!s},hostname:e=>b.test(e),date(e){const t=$.exec(e);if(!t)return!1;const[,i,r,n]=t,a=Number(i),s=Number(r),o=Number(n);if(s<1||s>12)return!1;if(o<1)return!1;const f=2===s?a%4!=0||a%100==0&&a%400!=0?28:29:S[s-1];return!!f&&o<=f},regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||A.test(e),"relative-json-pointer":e=>""===e||O.test(e),time:e=>w.test(e),"uri-reference":e=>!R.test(e)&&x.test(e),"uri-template":e=>P.test(e),duration:e=>l.test(e),uuid:e=>f.test(e),iri:e=>j.test(e),"iri-reference":e=>!R.test(e)&&_.test(e),"idn-email":e=>k.test(e),"idn-hostname":e=>V.test(e)},I={object:e=>n(e),array:e=>Array.isArray(e),string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e,timestamp:!1,int8:!1,unit8:!1,int16:!1,unit16:!1,int32:!1,unit32:!1,float32:!1,float64:!1},F={...{required(e,t,i){if(n(t))for(let r=0;r<e.required.length;r++){const n=e.required[r];if(!t.hasOwnProperty(n))return i("Required property is missing",{item:n,data:t[n]})}},properties(e,t,i){if(!n(t))return;let r=e._propKeys;r||(r=Object.keys(e.properties||{}),Object.defineProperty(e,"_propKeys",{value:r,enumerable:!1,configurable:!1,writable:!1}));let s=e._requiredKeys;void 0===s&&(s=Array.isArray(e.required)?e.required:null,Object.defineProperty(e,"_requiredKeys",{value:s,enumerable:!1,configurable:!1,writable:!1}));const o=s||[];for(let s=0;s<r.length;s++){const f=r[s],l=e.properties[f];if(Object.prototype.hasOwnProperty.call(t,f)){if("boolean"!=typeof l){if(l&&"$validate"in l){const e=l.$validate(t[f]);if(e)return i("Property is invalid",{item:f,cause:e,data:t[f]})}}else if(!1===l)return i("Property is not allowed",{item:f,data:t[f]})}else if(o.length&&-1!==o.indexOf(f)&&n(l)&&"default"in l){const e=l.$validate(l.default);if(e)return i("Default property is invalid",{item:f,cause:e,data:l.default});t[f]=a(l.default)}}},values(e,t,i){if(!n(t))return;const r=e.values,a=r&&r.$validate;if("function"!=typeof a)return;const s=Object.keys(t);for(let e=0;e<s.length;e++){const r=s[e],n=a(t[r]);if(n)return i("Property is invalid",{item:r,cause:n,data:t[r]})}},maxProperties(e,t,i){if(n(t)&&!(Object.keys(t).length<=e.maxProperties))return i("Too many properties",{data:t})},minProperties(e,t,i){if(n(t)&&!(Object.keys(t).length>=e.minProperties))return i("Too few properties",{data:t})},additionalProperties(e,t,i){if(!n(t))return;const r=Object.keys(t);let a=e._apIsCompiled;void 0===a&&(a=s(e.additionalProperties),Object.defineProperty(e,"_apIsCompiled",{value:a,enumerable:!1}));let o=e._patternPropertiesList;if(e.patternProperties&&!o){o=[];for(const t in e.patternProperties)o.push({regex:new RegExp(t,"u"),key:t});Object.defineProperty(e,"_patternPropertiesList",{value:o,enumerable:!1})}for(let n=0;n<r.length;n++){const f=r[n];if(!e.properties||!e.properties.hasOwnProperty(f)){if(o&&o.length){let e=!1;for(let t=0;t<o.length;t++)if(o[t].regex.test(f)){e=!0;break}if(e)continue}if(!1===e.additionalProperties)return i("Additional properties are not allowed",{item:f,data:t[f]});if(a&&s(e.additionalProperties)){const r=e.additionalProperties.$validate(t[f]);if(r)return i("Additional properties are invalid",{item:f,cause:r,data:t[f]})}}}},patternProperties(e,t,i){if(!n(t))return;let r=e._patternPropertiesList;if(!r){r=[];const t=Object.keys(e.patternProperties||{});for(let e=0;e<t.length;e++){const i=t[e];r.push({regex:new RegExp(i,"u"),key:i})}Object.defineProperty(e,"_patternPropertiesList",{value:r,enumerable:!1})}const a=Object.keys(t);for(let n=0;n<r.length;n++){const{regex:s,key:o}=r[n],f=e.patternProperties[o];if("boolean"!=typeof f){if("$validate"in f)for(let e=0;e<a.length;e++){const r=a[e];if(s.test(r)){const e=f.$validate(t[r]);if(e)return i("Property is invalid",{item:r,cause:e,data:t[r]})}}}else if(!1===f)for(let e=0;e<a.length;e++){const r=a[e];if(s.test(r))return i("Property is not allowed",{item:r,data:t[r]})}}},propertyNames(e,t,i){if(!n(t))return;const r=e.propertyNames;if("boolean"==typeof r)return!1===r&&Object.keys(t).length>0?i("Properties are not allowed",{data:t}):void 0;const a=r&&r.$validate;if("function"==typeof a)for(const e in t){if(!Object.prototype.hasOwnProperty.call(t,e))continue;const r=a(e);if(r)return i("Property name is invalid",{item:e,cause:r,data:t[e]})}},dependencies(e,t,i){if(n(t))for(const r in e.dependencies){if(r in t==!1)continue;const n=e.dependencies[r];if(Array.isArray(n)){for(let e=0;e<n.length;e++)if(!(n[e]in t))return i("Dependency is not satisfied",{item:e,data:n[e]});continue}if("boolean"==typeof n){if(n)continue;return i("Dependency is not satisfied",{data:n})}if("string"==typeof n){if(n in t)continue;return i("Dependency is not satisfied",{data:n})}const a=n.$validate(t);if(a)return i("Dependency is not satisfied",{cause:a,data:t})}},then:!1,else:!1,default:!1,definitions:!1,$id:!1,$schema:!1,title:!1,description:!1,$comment:!1,examples:!1,contentMediaType:!1,contentEncoding:!1,discriminator:!1,nullable:!1},...{items(e,t,i){if(!Array.isArray(t))return;const r=e.items,n=t.length;if("boolean"==typeof r)return!1===r&&n>0?i("Array items are not allowed",{data:t}):void 0;if(Array.isArray(r)){const e=r.length,a=e<n?e:n;for(let e=0;e<a;e++){const n=r[e];if("boolean"==typeof n){if(!1===n&&void 0!==t[e])return i("Array item is not allowed",{item:e,data:t[e]});continue}const a=n&&n.$validate;if("function"==typeof a){const r=a(t[e]);if(r)return i("Array item is invalid",{item:e,cause:r,data:t[e]})}}return}const a=r&&r.$validate;if("function"==typeof a)for(let e=0;e<n;e++){const r=a(t[e]);if(r)return i("Array item is invalid",{item:e,cause:r,data:t[e]})}},elements(e,t,i){if(!Array.isArray(t))return;const r=e.elements,n=r&&r.$validate;if("function"==typeof n)for(let e=0;e<t.length;e++){const r=n(t[e]);if(r)return i("Array item is invalid",{item:e,cause:r,data:t[e]})}},minItems(e,t,i){if(Array.isArray(t)&&!(t.length>=e.minItems))return i("Array is too short",{data:t})},maxItems(e,t,i){if(Array.isArray(t)&&!(t.length<=e.maxItems))return i("Array is too long",{data:t})},additionalItems(e,t,i){if(e.items&&!n(e.items)){if(!1===e.additionalItems)return t.length>e.items.length?i("Array is too long",{data:t}):void 0;if(n(e.additionalItems)){if(s(e.additionalItems)){for(let r=e.items.length;r<t.length;r++){const n=e.additionalItems.$validate(t[r]);if(n)return i("Array item is invalid",{item:r,cause:n,data:t[r]})}return}}else;}},uniqueItems(e,t,i){if(!Array.isArray(t)||!e.uniqueItems)return;const n=t.length;if(n<=1)return;const a=new Set;for(let e=0;e<n;e++){const n=t[e],s=typeof n;if(null!==n&&"string"!==s&&"number"!==s&&"boolean"!==s){if(n&&"object"==typeof n)for(let a=0;a<e;a++){const e=t[a];if(e&&"object"==typeof e&&!r(e,n))return i("Array items are not unique",{data:n})}}else{if(a.has(n))return i("Array items are not unique",{data:n});a.add(n)}}},contains(e,t,i){if(Array.isArray(t)){if("boolean"==typeof e.contains)return e.contains?0===t.length?i("Array must contain at least one item",{data:t}):void 0:i("Array must not contain any items",{data:t});for(let i=0;i<t.length;i++){if(!e.contains.$validate(t[i]))return}return i("Array must contain at least one item",{data:t})}}},...{minLength(e,t,i){if(!("string"!=typeof t||t.length>=e.minLength))return i("Value is shorter than the minimum length",{data:t})},maxLength(e,t,i){if(!("string"!=typeof t||t.length<=e.maxLength))return i("Value is longer than the maximum length",{data:t})},pattern(e,t,i){if("string"!=typeof t)return;let r=e._patternRegexp;if(!r)try{r=new RegExp(e.pattern,"u"),Object.defineProperty(e,"_patternRegexp",{value:r,enumerable:!1,configurable:!1,writable:!1})}catch(e){return i("Invalid regular expression",{data:t,cause:e})}return r.test(t)?void 0:i("Value does not match the pattern",{data:t})},format(e,t,i,r){if("string"!=typeof t)return;let n=e._formatValidate;return void 0===n&&(n=r.getFormat(e.format),Object.defineProperty(e,"_formatValidate",{value:n,enumerable:!1,configurable:!1,writable:!1})),n&&!n(t)?i("Value does not match the format",{data:t}):void 0}},...{minimum(e,t,i,r){if("number"!=typeof t)return;let n=e.minimum;return"number"==typeof e.exclusiveMinimum?n=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(n+=1e-15),t<n?i("Value is less than the minimum",{data:t}):void 0},maximum(e,t,i,r){if("number"!=typeof t)return;let n=e.maximum;return"number"==typeof e.exclusiveMaximum?n=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(n-=1e-15),t>n?i("Value is greater than the maximum",{data:t}):void 0},multipleOf(e,t,i,r){if("number"!=typeof t)return;const n=t/e.multipleOf;return isFinite(n)?function(e,t,i=1e-15){return Math.abs(e-t)<=i*Math.max(Math.abs(e),Math.abs(t))}(n,Math.round(n))?void 0:i("Value is not a multiple of the multipleOf",{data:t}):void 0},exclusiveMinimum(e,t,i,r){if("number"==typeof t&&"number"==typeof e.exclusiveMinimum&&!("minimum"in e))return t<=e.exclusiveMinimum+1e-15?i("Value is less than or equal to the exclusiveMinimum"):void 0},exclusiveMaximum(e,t,i,r){if("number"==typeof t&&"number"==typeof e.exclusiveMaximum&&!("maximum"in e))return t>=e.exclusiveMaximum?i("Value is greater than or equal to the exclusiveMaximum",{data:t}):void 0}},...{enum(e,t,i){const n=e.enum;for(let e=0;e<n.length;e++){const i=n[e];if(i===t)return;if(null!==i&&null!==t&&"object"==typeof i&&"object"==typeof t&&!r(i,t))return}return i("Value is not one of the allowed values",{data:t})},allOf(e,t,i){for(let r=0;r<e.allOf.length;r++)if(n(e.allOf[r])){if("$validate"in e.allOf[r]){const n=e.allOf[r].$validate(t);if(n)return i("Value is not valid",{cause:n,data:t})}}else if("boolean"!=typeof e.allOf[r]){if(t!==e.allOf[r])return i("Value is not valid",{data:t})}else if(Boolean(t)!==e.allOf[r])return i("Value is not valid",{data:t})},anyOf(e,t,i){for(let i=0;i<e.anyOf.length;i++){if(n(e.anyOf[i])){if("$validate"in e.anyOf[i]){if(!e.anyOf[i].$validate(t))return;continue}return}if("boolean"==typeof e.anyOf[i]&&Boolean(t)===e.anyOf[i])return;if(t===e.anyOf[i])return}return i("Value is not valid",{data:t})},oneOf(e,t,i){const r=e.oneOf;let a=0;for(let e=0;e<r.length;e++){const s=r[e];if(n(s)){if("$validate"in s){if(!s.$validate(t)&&(a++,a>1))return i("Value is not valid",{data:t});continue}if(a++,a>1)return i("Value is not valid",{data:t})}else if("boolean"!=typeof s){if(t===s&&(a++,a>1))return i("Value is not valid",{data:t})}else if(Boolean(t)===s&&(a++,a>1))return i("Value is not valid",{data:t})}if(1!==a)return i("Value is not valid",{data:t})},const(e,t,i){if(t!==e.const&&!(n(t)&&n(e.const)&&!r(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&!r(t,e.const)))return i("Value is not valid",{data:t})},if(e,t){if("then"in e==!1&&"else"in e==!1)return;if("boolean"==typeof e.if){if(e.if){if(s(e.then))return e.then.$validate(t)}else if(s(e.else))return e.else.$validate(t);return}if(!s(e.if))return;return e.if.$validate(t)?s(e.else)?e.else.$validate(t):void 0:s(e.then)?e.then.$validate(t):void 0},not(e,t,i){if("boolean"==typeof e.not)return e.not?i("Value is not valid",{data:t}):void 0;if(n(e.not)){if("$validate"in e.not){const r=e.not.$validate(t);return r?void 0:i("Value is not valid",{cause:r,data:t})}return i("Value is not valid",{data:t})}return i("Value is not valid",{data:t})},$ref(e,t,i,r){if(e._resolvedRef)return e._resolvedRef(t);const n=e.$ref;let a=r.getSchemaRef(n);return a||(a=r.getSchemaById(n)),a?a.$validate?(e._resolvedRef=a.$validate,e._resolvedRef(t)):void 0:i(`Missing reference: ${n}`)}}},z={SchemaShield:class{types={};formats={};keywords={};immutable=!1;rootSchema=null;idRegistry=new Map;failFast=!0;constructor({immutable:e=!1,failFast:t=!0}={}){this.immutable=e,this.failFast=t;for(const[e,t]of Object.entries(I))t&&this.addType(e,t);for(const[e,t]of Object.entries(F))this.addKeyword(e,t);for(const[e,t]of Object.entries(M))t&&this.addFormat(e,t)}addType(t,i,r=!1){if(this.types[t]&&!r)throw new e(`Type "${t}" already exists`);this.types[t]=i}getType(e){return this.types[e]}addFormat(t,i,r=!1){if(this.formats[t]&&!r)throw new e(`Format "${t}" already exists`);this.formats[t]=i}getFormat(e){return this.formats[e]}addKeyword(t,i,r=!1){if(this.keywords[t]&&!r)throw new e(`Keyword "${t}" already exists`);this.keywords[t]=i}getKeyword(e){return this.keywords[e]}getSchemaRef(e){if(this.rootSchema)return function(e,t){if(!t||"#"===t)return e;if(t.startsWith("#/")){const i=t.split("/").slice(1);let r=e;for(const e of i){const t=decodeURIComponent(e).replace(/~1/g,"/").replace(/~0/g,"~");if(!r||"object"!=typeof r||!(t in r))return;r=r[t]}return r}if(!t.includes("#")){if(e.definitions&&e.definitions[t])return e.definitions[t];if(e.defs&&e.defs[t])return e.defs[t];if(e.$id&&"string"==typeof e.$id&&(e.$id===t||e.$id.endsWith("/"+t)))return e}}(this.rootSchema,e)}getSchemaById(e){return this.idRegistry.get(e)}compile(t){this.idRegistry.clear();const i=this.compileSchema(t);if(this.rootSchema=i,this.linkReferences(i),!i.$validate){if(!1===this.isSchemaLike(t))throw new e("Invalid schema");i.$validate=o("Validate_Any",()=>{})}const r=e=>{this.rootSchema=i;const t=this.immutable?a(e):e,r=i.$validate(t);return r?{data:t,error:r,valid:!1}:{data:t,error:null,valid:!0}};return r.compiledSchema=i,r}compileSchema(e){n(e)||(e=!0===e?{anyOf:[{}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const t=a(e);if("string"==typeof e.$id&&this.idRegistry.set(e.$id,t),"$ref"in e){const r=this.getKeyword("$ref");if(r){const n=i("$ref",e.$ref,this.failFast);t.$validate=o("Validate_Reference",e=>r(t,e,n,this))}return t}const r=[],s=[];if("type"in e){const t=i("type",e,this.failFast),n=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim()),a=[],f=[];for(const e of n){const t=this.getType(e);t&&(a.push(t),f.push(t.name))}if(0===a.length)throw i("type",e,this.failFast)("Invalid type for schema",{data:e.type});let l,u="";if(1===a.length){u=f[0];const e=a[0];l=i=>{if(!e(i))return t("Invalid type",{data:i})}}else u=f.join("_OR_"),l=e=>{for(let t=0;t<a.length;t++)if(a[t](e))return;return t("Invalid type",{data:e})};const d=(e,t)=>l(t);r.push({fn:o(u,d),defineError:t}),s.push(u)}const{type:f,$id:l,$ref:u,$validate:d,required:c,...m}=e,p=c?[...Object.keys(m),"required"]:Object.keys(m);for(const t of p){const n=this.getKeyword(t);if(n){const a=i(t,e[t],this.failFast),o=n.name||t;r.push({fn:n,defineError:a}),s.push(o)}}const h=["enum","const","default","examples"];for(const i of p)if(!h.includes(i))if(n(e[i])){if("properties"===i){for(const r of Object.keys(e[i]))t[i][r]=this.compileSchema(e[i][r]);continue}t[i]=this.compileSchema(e[i])}else if(Array.isArray(e[i]))for(let r=0;r<e[i].length;r++)this.isSchemaLike(e[i][r])&&(t[i][r]=this.compileSchema(e[i][r]));else;if(0===r.length)return t;if(1===r.length){const e=r[0];t.$validate=o(s[0],i=>e.fn(t,i,e.defineError,this))}else{const e="Validate_"+s.join("_AND_"),i=e=>{for(let i=0;i<r.length;i++){const n=r[i],a=n.fn(t,e,n.defineError,this);if(a)return a}};t.$validate=o(e,i)}return t}isSchemaLike(e){if(n(e)){if("type"in e)return!0;for(let t in e)if(t in this.keywords)return!0}return!1}linkReferences(e){const t=[e];for(;t.length>0;){const e=t.pop();if(e&&"object"==typeof e){if("string"==typeof e.$ref&&"function"==typeof e.$validate&&"Validate_Reference"===e.$validate.name){const t=e.$ref;let r=this.getSchemaRef(t);if(void 0===r&&(r=this.getSchemaById(t)),"boolean"==typeof r){if(!0===r)e.$validate=o("Validate_Ref_True",()=>{});else{const t=i("$ref",e,this.failFast);e.$validate=o("Validate_Ref_False",e=>t("Value is not valid"))}continue}r&&"function"==typeof r.$validate&&(e.$validate=r.$validate)}for(const i in e){const r=e[i];if(r)if(Array.isArray(r))for(let e=0;e<r.length;e++){const i=r[e];i&&"object"==typeof i&&t.push(i)}else"object"==typeof r&&t.push(r)}}}}},ValidationError:e,deepClone:a};"undefined"!=typeof module?module.exports=z:self.SchemaShield=z})();//# sourceMappingURL=index.min.js.map