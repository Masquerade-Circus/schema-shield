(()=>{var e,t,i=Object.create,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,l=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r=/\/\d{1,3}(?=%|$)/,n=/\//,a=/%.*$/,o=/([^0-9a-f:/%])/i,s=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[i,r,n,a,o,s]}},function(){return t||(0,e[a(e)[0]])((t={exports:{}}).exports,t),t.exports}),f=class extends Error{message;item;keyword;cause;path="";data;schema;_getCause(e="#"){const t=e+"/"+this.keyword+(void 0!==this.item?"/"+this.item:"");return this.cause?this.cause._getCause(t):(this.path=t,this)}getCause(){return this._getCause()}};function u(e,t){const i=new f(`Invalid ${e}`);i.keyword=e,i.schema=t;return y(`defineError_${e}`,(e,t={})=>(i.message=e,i.item=t.item,i.cause=t.cause,i.data=t.data,i))}function d(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!d(e[i],t[i]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;for(const r of i)if(!d(e[r],t[r]))return!1;return!0}return e===t}function m(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){if(Array.isArray(e)){const t=[];for(let i=0;i<e.length;i++)t[i]=c(e[i]);return t}if(e&&e.constructor&&"Object"!==e.constructor.name)return e;if(m(e)){const t={...e};for(const i in e)t[i]=c(e[i]);return t}return e}function p(e){return m(e)&&"$validate"in e}function y(e,t){return Object.defineProperty(t,"name",{value:e})}var h=((e,t,l)=>(l=null!=e?i(o(e)):{},((e,t,i,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of a(t))s.call(e,l)||l===i||r(e,l,{get:()=>t[l],enumerable:!(o=n(t,l))||o.enumerable});return e})(!t&&e&&e.__esModule?l:r(l,"default",{value:e,enumerable:!0}),e)))(l()),v={"date-time":/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},g={"date-time"(e){const t=e.toUpperCase();if(!v["date-time"].test(t))return!1;const i=new Date(t);return!isNaN(i.getTime())},uri:e=>v.uri.test(e),email(e){if(!v.email.test(e))return!1;const[t,i]=e.split("@");return!(t.length>64||-1!==t.indexOf("..")||"."===t[0]||"."===t[t.length-1])&&!(i.length>255||-1!==i.indexOf("..")||"."===i[0]||"."===i[i.length-1])},ipv4:(0,h.default)({version:4}),ipv6:(0,h.default)({version:6}),hostname:e=>v.hostname.test(e),date:e=>"string"==typeof e&&(!1!==v.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||v["json-pointer"].test(e),"relative-json-pointer":e=>""===e||v["relative-json-pointer"].test(e),time:e=>v.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},A={object:e=>m(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e,timestamp:!1,int8:!1,unit8:!1,int16:!1,unit16:!1,int32:!1,unit32:!1,float32:!1,float64:!1},b={...{required(e,t,i){if(m(t))for(let r=0;r<e.required.length;r++){const n=e.required[r];if(!t.hasOwnProperty(n))return i("Required property is missing",{item:n,data:t[n]})}},properties(e,t,i){if(m(t))for(const r of Object.keys(e.properties))if(t.hasOwnProperty(r)){if("boolean"!=typeof e.properties[r]){if("$validate"in e.properties[r]){const n=e.properties[r].$validate(t[r]);if(n)return i("Property is invalid",{item:r,cause:n,data:t[r]})}}else if(!1===e.properties[r])return i("Property is not allowed",{item:r,data:t[r]})}else{const i=e.properties[r];m(i)&&"default"in i&&(t[r]=i.default)}},values(e,t,i){if(!m(t)||!p(e.values))return;const r=Object.keys(t);for(const n of r){const r=e.values.$validate(t[n]);if(r)return i("Property is invalid",{item:n,cause:r,data:t[n]})}},maxProperties(e,t,i){if(m(t)&&!(Object.keys(t).length<=e.maxProperties))return i("Too many properties",{data:t})},minProperties(e,t,i){if(m(t)&&!(Object.keys(t).length>=e.minProperties))return i("Too few properties",{data:t})},additionalProperties(e,t,i){if(!m(t))return;const r=Object.keys(t),n=p(e.additionalProperties);for(const a of r)if(!e.properties||!e.properties.hasOwnProperty(a)){if(e.patternProperties){let t=!1;for(const i in e.patternProperties)if(new RegExp(i,"u").test(a)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)return i("Additional properties are not allowed",{item:a,data:t[a]});if(n){const r=e.additionalProperties.$validate(t[a]);if(r)return i("Additional properties are invalid",{item:a,cause:r,data:t[a]})}}},patternProperties(e,t,i){if(!m(t))return;const r=Object.keys(e.patternProperties);for(const n of r){const r=new RegExp(n,"u");if("boolean"==typeof e.patternProperties[n]){if(!1===e.patternProperties[n])for(const e in t)if(r.test(e))return i("Property is not allowed",{item:e,data:t[e]});continue}const a=Object.keys(t);for(const o of a)if(r.test(o)&&"$validate"in e.patternProperties[n]){const r=e.patternProperties[n].$validate(t[o]);if(r)return i("Property is invalid",{item:o,cause:r,data:t[o]})}}},propertyNames(e,t,i){if(m(t)){if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)return i("Properties are not allowed",{data:t});if(p(e.propertyNames))for(let r in t){const n=e.propertyNames.$validate(r);if(n)return i("Property name is invalid",{item:r,cause:n,data:t[r]})}}},dependencies(e,t,i){if(m(t))for(const r in e.dependencies){if(r in t==!1)continue;const n=e.dependencies[r];if(Array.isArray(n)){for(let e=0;e<n.length;e++)if(!(n[e]in t))return i("Dependency is not satisfied",{item:e,data:n[e]});continue}if("boolean"==typeof n){if(n)continue;return i("Dependency is not satisfied",{data:n})}if("string"==typeof n){if(n in t)continue;return i("Dependency is not satisfied",{data:n})}const a=n.$validate(t);if(a)return i("Dependency is not satisfied",{cause:a,data:t})}},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,description:!1,$comment:!1,examples:!1,contentMediaType:!1,contentEncoding:!1,discriminator:!1,nullable:!1},...{items(e,t,i){if(!Array.isArray(t))return;const r=e.items,n=t.length;if("boolean"==typeof r)return!1===r&&n>0?i("Array items are not allowed",{data:t}):void 0;if(Array.isArray(r)){const e=r.length,a=Math.min(e,n);for(let e=0;e<a;e++){const n=r[e];if("boolean"!=typeof n){if(p(n)){const r=n.$validate(t[e]);if(r)return i("Array item is invalid",{item:e,cause:r,data:t[e]})}}else if(!1===n&&void 0!==t[e])return i("Array item is not allowed",{item:e,data:t[e]})}}else if(p(r))for(let e=0;e<n;e++){const n=r.$validate(t[e]);if(n)return i("Array item is invalid",{item:e,cause:n,data:t[e]})}},elements(e,t,i){if(Array.isArray(t)&&p(e.elements))for(let r=0;r<t.length;r++){const n=e.elements.$validate(t[r]);if(n)return i("Array item is invalid",{item:r,cause:n,data:t[r]})}},minItems(e,t,i){if(Array.isArray(t)&&!(t.length>=e.minItems))return i("Array is too short",{data:t})},maxItems(e,t,i){if(Array.isArray(t)&&!(t.length<=e.maxItems))return i("Array is too long",{data:t})},additionalItems(e,t,i){if(Array.isArray(t)&&e.items&&Array.isArray(e.items)){if(!1===e.additionalItems)return t.length>e.items.length?i("Array is too long",{data:t}):void 0;if(m(e.additionalItems)){if(p(e.additionalItems)){for(let r=e.items.length;r<t.length;r++){const n=e.additionalItems.$validate(t[r]);if(n)return i("Array item is invalid",{item:r,cause:n,data:t[r]})}return}}else;}},uniqueItems(e,t,i){if(!Array.isArray(t)||!e.uniqueItems)return;const r=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:m(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),r.has(t))return i("Array items are not unique",{data:e});r.add(t)}},contains(e,t,i){if(Array.isArray(t)){if("boolean"==typeof e.contains)return e.contains?0===t.length?i("Array must contain at least one item",{data:t}):void 0:i("Array must not contain any items",{data:t});for(let i=0;i<t.length;i++){if(!e.contains.$validate(t[i]))return}return i("Array must contain at least one item",{data:t})}}},...{minLength(e,t,i){if(!("string"!=typeof t||t.length>=e.minLength))return i("Value is shorter than the minimum length",{data:t})},maxLength(e,t,i){if(!("string"!=typeof t||t.length<=e.maxLength))return i("Value is longer than the maximum length",{data:t})},pattern(e,t,i){if("string"!=typeof t)return;const r=new RegExp(e.pattern,"u");return r instanceof RegExp==!1?i("Invalid regular expression",{data:t}):r.test(t)?void 0:i("Value does not match the pattern",{data:t})},format(e,t,i,r){if("string"!=typeof t)return;const n=r.formats.get(e.format);if(!1!==n){if("function"==typeof n){if(n(t))return;return i("Value does not match the format",{data:t})}return i("Format is not supported",{data:t})}}},...{minimum(e,t,i,r){if("number"!=typeof t)return;let n=e.minimum;return"number"==typeof e.exclusiveMinimum?n=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(n+=1e-15),t<n?i("Value is less than the minimum",{data:t}):void 0},maximum(e,t,i,r){if("number"!=typeof t)return;let n=e.maximum;return"number"==typeof e.exclusiveMaximum?n=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(n-=1e-15),t>n?i("Value is greater than the maximum",{data:t}):void 0},multipleOf(e,t,i,r){if("number"!=typeof t)return;const n=t/e.multipleOf;return isFinite(n)?function(e,t,i=1e-15){return Math.abs(e-t)<=i*Math.max(Math.abs(e),Math.abs(t))}(n,Math.round(n))?void 0:i("Value is not a multiple of the multipleOf",{data:t}):void 0},exclusiveMinimum(e,t,i,r){if("number"==typeof t&&"number"==typeof e.exclusiveMinimum&&!("minimum"in e))return t<=e.exclusiveMinimum+1e-15?i("Value is less than or equal to the exclusiveMinimum"):void 0},exclusiveMaximum(e,t,i,r){if("number"==typeof t&&"number"==typeof e.exclusiveMaximum&&!("maximum"in e))return t>=e.exclusiveMaximum?i("Value is greater than or equal to the exclusiveMaximum",{data:t}):void 0}},...{enum(e,t,i){const r=Array.isArray(t),n="object"==typeof t&&null!==t;for(let i=0;i<e.enum.length;i++){const a=e.enum[i];if(a===t)return;if((r&&Array.isArray(a)||n&&"object"==typeof a&&null!==a)&&d(a,t))return}return i("Value is not one of the allowed values",{data:t})},allOf(e,t,i){for(let r=0;r<e.allOf.length;r++)if(m(e.allOf[r])){if("$validate"in e.allOf[r]){const n=e.allOf[r].$validate(t);if(n)return i("Value is not valid",{cause:n,data:t})}}else if("boolean"!=typeof e.allOf[r]){if(t!==e.allOf[r])return i("Value is not valid",{data:t})}else if(Boolean(t)!==e.allOf[r])return i("Value is not valid",{data:t})},anyOf(e,t,i){for(let i=0;i<e.anyOf.length;i++){if(m(e.anyOf[i])){if("$validate"in e.anyOf[i]){if(!e.anyOf[i].$validate(t))return;continue}return}if("boolean"==typeof e.anyOf[i]&&Boolean(t)===e.anyOf[i])return;if(t===e.anyOf[i])return}return i("Value is not valid",{data:t})},oneOf(e,t,i){let r=0;for(let i=0;i<e.oneOf.length;i++)if(m(e.oneOf[i])){if("$validate"in e.oneOf[i]){e.oneOf[i].$validate(t)||r++;continue}r++}else"boolean"!=typeof e.oneOf[i]?t===e.oneOf[i]&&r++:Boolean(t)===e.oneOf[i]&&r++;if(1!==r)return i("Value is not valid",{data:t})},const(e,t,i){if(!(t===e.const||m(t)&&m(e.const)&&d(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&d(t,e.const)))return i("Value is not valid",{data:t})},if(e,t,i){if("then"in e==!1&&"else"in e==!1)return;if("boolean"==typeof e.if){if(e.if){if(p(e.then))return e.then.$validate(t)}else if(p(e.else))return e.else.$validate(t);return}if(!p(e.if))return;return e.if.$validate(t)?p(e.else)?e.else.$validate(t):void 0:p(e.then)?e.then.$validate(t):void 0},not(e,t,i){if("boolean"==typeof e.not)return e.not?i("Value is not valid",{data:t}):void 0;if(m(e.not)){if("$validate"in e.not){const r=e.not.$validate(t);return r?void 0:i("Value is not valid",{cause:r,data:t})}return i("Value is not valid",{data:t})}return i("Value is not valid",{data:t})}}},O={SchemaShield:class{types=new Map;formats=new Map;keywords=new Map;immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(A))t&&this.addType(e,t);for(const[e,t]of Object.entries(b))this.addKeyword(e,t);for(const[e,t]of Object.entries(g))t&&this.addFormat(e,t)}addType(e,t){this.types.set(e,t)}addFormat(e,t){this.formats.set(e,t)}addKeyword(e,t){this.keywords.set(e,t)}compile(e){const t=this.compileSchema(e);if(!t.$validate){if(!1===this.isSchemaLike(e))throw new f("Invalid schema");t.$validate=y("any",()=>{})}const i=e=>{const i=this.immutable?c(e):e,r=t.$validate(i);return{data:i,error:r||null,valid:!r}};return i.compiledSchema=t,i}compileSchema(e){m(e)||(e=!0===e?{anyOf:[{}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const t={...e},i=u("type",e),r=[];let n="";if("type"in e){const a=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim());for(const e of a){const t=this.types.get(e);t&&(r.push(t),n+=(n?"_OR_":"")+t.name)}const o=r.length;if(0===o)throw i("Invalid type for schema",{data:e.type});if(1===o){const e=r[0];t.$validate=y(n,t=>{if(!e(t))return i("Invalid type",{data:t})})}else o>1&&(t.$validate=y(n,e=>{for(let t=0;t<o;t++)if(r[t](e))return;return i("Invalid type",{data:e})}))}for(const i of Object.keys(e)){if("type"===i){t.type=e.type;continue}const r=this.keywords.get(i);if(r){const a=u(i,e[i]),o=e=>r(t,e,a,this);if(t.$validate){const e=t.$validate;n+=`_AND_${r.name}`,t.$validate=y(n,t=>{const i=e(t);if(i)return i;const r=o(t);return r||void 0})}else n=r.name,t.$validate=y(n,o)}m(e[i])?t[i]=this.compileSchema(e[i]):Array.isArray(e[i])?t[i]=e[i].map((e,t)=>this.isSchemaLike(e)?this.compileSchema(e):e):t[i]=e[i]}return t}isSchemaLike(e){if(m(e)){if("type"in e)return!0;for(let t in e)if(this.keywords.has(t))return!0}return!1}}};"undefined"!=typeof module?module.exports=O:self.SchemaShield=O})();//# sourceMappingURL=index.min.js.map