(()=>{var e,t,n=Object.create,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,o=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,s=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var n=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r=/\/\d{1,3}(?=%|$)/,i=/\//,l=/%.*$/,o=/([^0-9a-f:/%])/i,a=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[n,r,i,l,o,a]}},function(){return t||(0,e[l(e)[0]])((t={exports:{}}).exports,t),t.exports}),u=class extends Error{name;pointer;message;value;code;item;constructor(e,t){super(e),this.pointer=t}};function f(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!f(e[n],t[n]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!f(e[r],t[r]))return!1;return!0}return e===t}function m(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t[n]=c(e[n]);return t}if(m(e)){const t={};for(const n in e)t[n]=c(e[n]);return t}return e}function p(e){return m(e)&&"$validate"in e}function y(e,t){return Object.defineProperty(t,"name",{value:e})}var d=((e,t,s)=>(s=null!=e?n(o(e)):{},((e,t,n,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of l(t))a.call(e,s)||s===n||r(e,s,{get:()=>t[s],enumerable:!(o=i(t,s))||o.enumerable});return e})(!t&&e&&e.__esModule?s:r(s,"default",{value:e,enumerable:!0}),e)))(s()),h={"date-time":/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},g={"date-time"(e){const t=e.toUpperCase();if(!h["date-time"].test(t))return!1;const n=new Date(t);return!isNaN(n.getTime())},uri:e=>h.uri.test(e),email(e){if(!h.email.test(e))return!1;const[t,n]=e.split("@");return!(t.length>64||-1!==t.indexOf("..")||"."===t[0]||"."===t[t.length-1])&&!(n.length>255||-1!==n.indexOf("..")||"."===n[0]||"."===n[n.length-1])},ipv4:(0,d.default)({version:4}),ipv6:(0,d.default)({version:6}),hostname:e=>h.hostname.test(e),date:e=>"string"==typeof e&&(!1!==h.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||h["json-pointer"].test(e),"relative-json-pointer":e=>""===e||h["relative-json-pointer"].test(e),time:e=>h.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},b={object:e=>m(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e},v={...{required(e,t,n){if(!m(t))return[!0,null];for(let r=0;r<e.required.length;r++){const i=e.required[r];if(!t.hasOwnProperty(i))return n.item=i,[!1,n]}return[!0,null]},properties(e,t,n){if(!m(t))return[!0,null];const r=Object.keys(e.properties);for(const i of r)if(void 0!==t[i]){if("boolean"!=typeof e.properties[i]){if("$validate"in e.properties[i]){const[r,l]=e.properties[i].$validate(t[i]);if(!r)return n.item=i,[!1,n]}}else if(!1===e.properties[i])return n.item=i,[!1,n]}else{const n=e.properties[i];m(n)&&"default"in n&&(t[i]=n.default)}return[!0,null]},maxProperties:(e,t,n)=>!m(t)||Object.keys(t).length<=e.maxProperties?[!0,null]:[!1,n],minProperties:(e,t,n)=>!m(t)||Object.keys(t).length>=e.minProperties?[!0,null]:[!1,n],additionalProperties(e,t,n){if(!m(t))return[!0,null];const r=Object.keys(t),i=p(e.additionalProperties);for(const l of r)if(!e.properties||!e.properties.hasOwnProperty(l)){if(e.patternProperties){let t=!1;for(const n in e.patternProperties)if(new RegExp(n,"u").test(l)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)return n.item=l,[!1,n];if(i){const[r,i]=e.additionalProperties.$validate(t[l]);if(!r)return n.item=l,[!1,n]}}return[!0,null]},patternProperties(e,t,n){if(!m(t))return[!0,null];const r=Object.keys(e.patternProperties);for(const i of r){const r=new RegExp(i,"u");if("boolean"==typeof e.patternProperties[i]){if(!1===e.patternProperties[i])for(const e in t)if(r.test(e))return n.item=e,[!1,n];continue}const l=Object.keys(t);for(const o of l)if(r.test(o)&&"$validate"in e.patternProperties[i]){const[r,l]=e.patternProperties[i].$validate(t[o]);if(!r)return n.item=o,[!1,n]}}return[!0,null]},propertyNames(e,t,n){if(!m(t))return[!0,null];if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)return[!1,n];if(p(e.propertyNames))for(let r in t){const[t,i]=e.propertyNames.$validate(r);if(!t)return n.item=r,[!1,n]}return[!0,null]},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,$comment:!1,contentMediaType:!1,contentEncoding:!1},...{items(e,t,n){if(!Array.isArray(t))return[!0,null];const r=e.items,i=t.length;if("boolean"==typeof r)return!1===r&&i>0?[!1,n]:[!0,null];if(Array.isArray(r)){const e=r.length,l=Math.min(e,i);for(let e=0;e<l;e++){const i=r[e];if("boolean"!=typeof i){if(p(i)){const[r,l]=i.$validate(t[e]);if(!r)return n.message=l.message,n.item=e,[!1,n]}}else if(!1===i&&void 0!==t[e])return n.message="Array item is not allowed",n.item=e,[!1,n]}return[!0,null]}if(p(r))for(let e=0;e<i;e++){const[i,l]=r.$validate(t[e]);if(!i)return n.message=l.message,n.item=e,[!1,n]}return[!0,null]},minItems:(e,t,n,r)=>!Array.isArray(t)||t.length>=e.minItems?[!0,null]:[!1,n],maxItems:(e,t,n,r)=>!Array.isArray(t)||t.length<=e.maxItems?[!0,null]:[!1,n],additionalItems(e,t,n,r){if(!Array.isArray(t)||!e.items||!Array.isArray(e.items))return[!0,null];if(!1===e.additionalItems)return t.length>e.items.length?[!1,n]:[!0,null];if(m(e.additionalItems)){if(p(e.additionalItems)){for(let r=e.items.length;r<t.length;r++){const[i,l]=e.additionalItems.$validate(t[r]);if(!i)return n.message=l.message,n.item=r,[!1,n]}return[!0,null]}return[!0,null]}return[!0,null]},uniqueItems(e,t,n){if(!Array.isArray(t)||!e.uniqueItems)return[!0,null];const r=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:m(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),r.has(t))return[!1,n];r.add(t)}return[!0,null]},contains(e,t,n){if(!Array.isArray(t))return[!0,null];if("boolean"==typeof e.contains)return e.contains?0===t.length?[!1,n]:[!0,null]:[!1,n];for(let n=0;n<t.length;n++){const[r,i]=e.contains.$validate(t[n]);if(r)return[!0,null]}return[!1,n]}},...{minLength:(e,t,n)=>"string"!=typeof t||t.length>=e.minLength?[!0,null]:[!1,n],maxLength:(e,t,n)=>"string"!=typeof t||t.length<=e.maxLength?[!0,null]:[!1,n],pattern(e,t,n){if("string"!=typeof t)return[!0,null];const r=new RegExp(e.pattern,"u");return r instanceof RegExp==!1?[!1,n]:r.test(t)?[!0,null]:[!1,n]},format(e,t,n,r){if("string"!=typeof t)return[!0,null];const i=r.formats.get(e.format);return!1===i||"function"==typeof i&&i(t)?[!0,null]:[!1,n]},enum(e,t,n){const r=Array.isArray(t),i="object"==typeof t&&null!==t;for(let n=0;n<e.enum.length;n++){const l=e.enum[n];if(l===t)return[!0,null];if((r&&Array.isArray(l)||i&&"object"==typeof l&&null!==l)&&f(l,t))return[!0,null]}return[!1,n]}},...{minimum(e,t,n,r){if("number"!=typeof t)return[!0,null];let i=e.minimum;return"number"==typeof e.exclusiveMinimum?i=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(i+=1e-15),t<i?[!1,n]:[!0,null]},maximum(e,t,n,r){if("number"!=typeof t)return[!0,null];let i=e.maximum;return"number"==typeof e.exclusiveMaximum?i=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(i-=1e-15),t>i?[!1,n]:[!0,null]},multipleOf(e,t,n,r){if("number"!=typeof t)return[!0,null];const i=t/e.multipleOf;return isFinite(i)?function(e,t,n=1e-15){return Math.abs(e-t)<=n*Math.max(Math.abs(e),Math.abs(t))}(i,Math.round(i))?[!0,null]:[!1,n]:[!0,null]},exclusiveMinimum:(e,t,n,r)=>"number"!=typeof t||"number"!=typeof e.exclusiveMinimum||"minimum"in e?[!0,null]:t<=e.exclusiveMinimum+1e-15?[!1,n]:[!0,null],exclusiveMaximum:(e,t,n,r)=>"number"!=typeof t||"number"!=typeof e.exclusiveMaximum||"maximum"in e?[!0,null]:t>=e.exclusiveMaximum?[!1,n]:[!0,null]},...{nullable:(e,t,n)=>e.nullable&&null!==t?[!1,n]:[!0,null],allOf(e,t,n){for(let r=0;r<e.allOf.length;r++)if(m(e.allOf[r])){if("$validate"in e.allOf[r]){const[i,l]=e.allOf[r].$validate(t);if(!i)return[!1,n]}}else if("boolean"!=typeof e.allOf[r]){if(t!==e.allOf[r])return[!1,n]}else if(Boolean(t)!==e.allOf[r])return[!1,n];return[!0,null]},anyOf(e,t,n){for(let n=0;n<e.anyOf.length;n++){if(m(e.anyOf[n])){if("$validate"in e.anyOf[n]){const[r,i]=e.anyOf[n].$validate(t);if(r)return[!0,null];continue}return[!0,null]}if("boolean"==typeof e.anyOf[n]&&Boolean(t)===e.anyOf[n])return[!0,null];if(t===e.anyOf[n])return[!0,null]}return[!1,n]},oneOf(e,t,n){let r=0;for(let n=0;n<e.oneOf.length;n++)if(m(e.oneOf[n])){if("$validate"in e.oneOf[n]){const[i,l]=e.oneOf[n].$validate(t);i&&r++;continue}r++}else"boolean"!=typeof e.oneOf[n]?t===e.oneOf[n]&&r++:Boolean(t)===e.oneOf[n]&&r++;return 1===r?[!0,null]:[!1,n]},dependencies(e,t,n){if(!m(t))return[!0,null];for(const r in e.dependencies){if(r in t==!1)continue;const i=e.dependencies[r];if(Array.isArray(i)){for(let e=0;e<i.length;e++)if(!(i[e]in t))return n.item=e,[!1,n];continue}if("boolean"==typeof i){if(i)continue;return[!1,n]}if("string"==typeof i){if(i in t)continue;return[!1,n]}const[l,o]=i.$validate(t);if(!l)return[!1,o]}return[!0,null]},const:(e,t,n)=>t===e.const||m(t)&&m(e.const)&&f(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&f(t,e.const)?[!0,null]:[!1,n],if(e,t,n){if("then"in e==!1&&"else"in e==!1)return[!0,null];if("boolean"==typeof e.if){if(e.if){if(e.then)return e.then.$validate(t)}else if(e.else)return e.else.$validate(t);return[!0,null]}const[r,i]=e.if.$validate(t);return r?e.then?e.then.$validate(t):[!0,null]:e.else?e.else.$validate(t):[!0,null]},not(e,t,n){if("boolean"==typeof e.not)return e.not?[!1,n]:[!0,null];if(m(e.not)){if("$validate"in e.not){const[r,i]=e.not.$validate(t);return r?[!1,n]:[!0,null]}return[!1,n]}return[!1,n]}}},O={SchemaShield:class{types=new Map;formats=new Map;keywords=new Map;immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(b))this.addType(e,t);for(const[e,t]of Object.entries(v))this.addKeyword(e,t);for(const[e,t]of Object.entries(g))t&&this.addFormat(e,t)}addType(e,t){this.types.set(e,t)}addFormat(e,t){this.formats.set(e,t)}addKeyword(e,t){this.keywords.set(e,t)}compile(e){const t=this.compileSchema(e,"#");if(!t.$validate){if(!1===this.isSchemaLike(e))throw new u("Invalid schema","#");t.$validate=y("any",e=>[!0,null])}const n=e=>(this.immutable&&(e=c(e)),t.$validate(e));return n.compiledSchema=t,n}compileSchema(e,t){m(e)||(e=!0===e?{anyOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array"},{type:"object"},{type:"null"}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const n={};if("type"in e){const r=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim()),i=[];let l="";for(const e of r){const t=this.types.get(e);t&&(i.push(t),l+=(l?"_OR_":"")+t.name)}const o=new u("Invalid type",t);if(0===i.length)throw o;if(1===i.length){const e=i[0];n.$validate=y(l,t=>e(t)?[!0,null]:[!1,o])}else n.$validate=y(l,e=>{for(const t of i)if(t(e))return[!0,null];return[!1,o]})}for(let r in e){if("type"===r)continue;let i=this.keywords.get(r);if(i){const e=new u(`Invalid ${r}`,t);if(n.$validate){const t=n.$validate,r=`${t.name}_AND_${i.name}`;n.$validate=y(r,r=>{let[l,o]=t(r);return l?i(n,r,e,this):[!1,o]})}else n.$validate=y(i.name,t=>i(n,t,e,this))}m(e[r])?n[r]=this.compileSchema(e[r],`${t}/${r}`):Array.isArray(e[r])?n[r]=e[r].map((e,n)=>this.isSchemaLike(e)?this.compileSchema(e,`${t}/${r}/${n}`):e):n[r]=e[r]}return n}isSchemaLike(e){if(m(e)){if("type"in e)return!0;for(let t in e)if(this.keywords.has(t))return!0}return!1}}};"undefined"!=typeof module?module.exports=O:self.SchemaShield=O})();//# sourceMappingURL=index.min.js.map