(()=>{var e,t,r=Object.create,i=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,f=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i=/\/\d{1,3}(?=%|$)/,n=/\//,o=/%.*$/,a=/([^0-9a-f:/%])/i,s=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[r,i,n,o,a,s]}},function(){return t||(0,e[o(e)[0]])((t={exports:{}}).exports,t),t.exports}),l=class extends Error{message;item;keyword;cause;path="";_getCause(e="#"){const t=e+"/"+this.keyword+("item"in this?"/"+this.item:"");return this.cause?this.cause._getCause(t):(this.path=t,this)}getCause(){return this._getCause()}};function u(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!u(e[r],t[r]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const i of r)if(!u(e[i],t[i]))return!1;return!0}return e===t}function c(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function m(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=m(e[r]);return t}if(c(e)){const t={};for(const r in e)t[r]=m(e[r]);return t}return e}function d(e){return c(e)&&"$validate"in e}function p(e,t){return Object.defineProperty(t,"name",{value:e})}var y=((e,t,f)=>(f=null!=e?r(a(e)):{},((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let f of o(t))s.call(e,f)||f===r||i(e,f,{get:()=>t[f],enumerable:!(a=n(t,f))||a.enumerable});return e})(!t&&e&&e.__esModule?f:i(f,"default",{value:e,enumerable:!0}),e)))(f()),h={"date-time":/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},v={"date-time"(e){const t=e.toUpperCase();if(!h["date-time"].test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())},uri:e=>h.uri.test(e),email(e){if(!h.email.test(e))return!1;const[t,r]=e.split("@");return!(t.length>64||-1!==t.indexOf("..")||"."===t[0]||"."===t[t.length-1])&&!(r.length>255||-1!==r.indexOf("..")||"."===r[0]||"."===r[r.length-1])},ipv4:(0,y.default)({version:4}),ipv6:(0,y.default)({version:6}),hostname:e=>h.hostname.test(e),date:e=>"string"==typeof e&&(!1!==h.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||h["json-pointer"].test(e),"relative-json-pointer":e=>""===e||h["relative-json-pointer"].test(e),time:e=>h.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},g={object:e=>c(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e},b={...{required(e,t,r){if(c(t))for(let i=0;i<e.required.length;i++){const n=e.required[i];if(!t.hasOwnProperty(n))return r.item=n,r}},properties(e,t,r){if(!c(t))return;const i=Object.keys(e.properties);for(const n of i)if(void 0!==t[n]){if("boolean"!=typeof e.properties[n]){if("$validate"in e.properties[n]){const i=e.properties[n].$validate(t[n]);if(i)return r.item=n,r.cause=i,r}}else if(!1===e.properties[n])return r.item=n,r}else{const r=e.properties[n];c(r)&&"default"in r&&(t[n]=r.default)}},maxProperties(e,t,r){if(c(t)&&!(Object.keys(t).length<=e.maxProperties))return r},minProperties(e,t,r){if(c(t)&&!(Object.keys(t).length>=e.minProperties))return r},additionalProperties(e,t,r){if(!c(t))return;const i=Object.keys(t),n=d(e.additionalProperties);for(const o of i)if(!e.properties||!e.properties.hasOwnProperty(o)){if(e.patternProperties){let t=!1;for(const r in e.patternProperties)if(new RegExp(r,"u").test(o)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)return r.item=o,r;if(n){const i=e.additionalProperties.$validate(t[o]);if(i)return r.item=o,r.cause=i,r}}},patternProperties(e,t,r){if(!c(t))return;const i=Object.keys(e.patternProperties);for(const n of i){const i=new RegExp(n,"u");if("boolean"==typeof e.patternProperties[n]){if(!1===e.patternProperties[n])for(const e in t)if(i.test(e))return r.item=e,r;continue}const o=Object.keys(t);for(const a of o)if(i.test(a)&&"$validate"in e.patternProperties[n]){const i=e.patternProperties[n].$validate(t[a]);if(i)return r.item=a,r.cause=i,r}}},propertyNames(e,t,r){if(c(t)){if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)return r;if(d(e.propertyNames))for(let i in t){const t=e.propertyNames.$validate(i);if(t)return r.item=i,r.cause=t,r}}},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,$comment:!1,contentMediaType:!1,contentEncoding:!1},...{items(e,t,r){if(!Array.isArray(t))return;const i=e.items,n=t.length;if("boolean"==typeof i)return!1===i&&n>0?r:void 0;if(Array.isArray(i)){const e=i.length,o=Math.min(e,n);for(let e=0;e<o;e++){const n=i[e];if("boolean"!=typeof n){if(d(n)){const i=n.$validate(t[e]);if(i)return r.item=e,r.cause=i,r}}else if(!1===n&&void 0!==t[e])return r.message="Array item is not allowed",r.item=e,r}}else if(d(i))for(let e=0;e<n;e++){const n=i.$validate(t[e]);if(n)return r.item=e,r.cause=n,r}},minItems(e,t,r){if(Array.isArray(t)&&!(t.length>=e.minItems))return r},maxItems(e,t,r){if(Array.isArray(t)&&!(t.length<=e.maxItems))return r},additionalItems(e,t,r){if(Array.isArray(t)&&e.items&&Array.isArray(e.items)){if(!1===e.additionalItems)return t.length>e.items.length?r:void 0;if(c(e.additionalItems)){if(d(e.additionalItems)){for(let i=e.items.length;i<t.length;i++){const n=e.additionalItems.$validate(t[i]);if(n)return r.item=i,r.cause=n,r}return}}else;}},uniqueItems(e,t,r){if(!Array.isArray(t)||!e.uniqueItems)return;const i=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:c(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),i.has(t))return r;i.add(t)}},contains(e,t,r){if(Array.isArray(t)){if("boolean"==typeof e.contains)return e.contains?0===t.length?r:void 0:r;for(let r=0;r<t.length;r++){if(!e.contains.$validate(t[r]))return}return r}}},...{minLength(e,t,r){if(!("string"!=typeof t||t.length>=e.minLength))return r},maxLength(e,t,r){if(!("string"!=typeof t||t.length<=e.maxLength))return r},pattern(e,t,r){if("string"!=typeof t)return;const i=new RegExp(e.pattern,"u");return i instanceof RegExp==!1?r:i.test(t)?void 0:r},format(e,t,r,i){if("string"!=typeof t)return;const n=i.formats.get(e.format);if(!1!==n){if("function"==typeof n){if(n(t))return;return r}return r}},enum(e,t,r){const i=Array.isArray(t),n="object"==typeof t&&null!==t;for(let r=0;r<e.enum.length;r++){const o=e.enum[r];if(o===t)return;if((i&&Array.isArray(o)||n&&"object"==typeof o&&null!==o)&&u(o,t))return}return r}},...{minimum(e,t,r,i){if("number"!=typeof t)return;let n=e.minimum;return"number"==typeof e.exclusiveMinimum?n=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(n+=1e-15),t<n?r:void 0},maximum(e,t,r,i){if("number"!=typeof t)return;let n=e.maximum;return"number"==typeof e.exclusiveMaximum?n=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(n-=1e-15),t>n?r:void 0},multipleOf(e,t,r,i){if("number"!=typeof t)return;const n=t/e.multipleOf;return isFinite(n)?function(e,t,r=1e-15){return Math.abs(e-t)<=r*Math.max(Math.abs(e),Math.abs(t))}(n,Math.round(n))?void 0:r:void 0},exclusiveMinimum(e,t,r,i){if("number"==typeof t&&"number"==typeof e.exclusiveMinimum&&!("minimum"in e))return t<=e.exclusiveMinimum+1e-15?r:void 0},exclusiveMaximum(e,t,r,i){if("number"==typeof t&&"number"==typeof e.exclusiveMaximum&&!("maximum"in e))return t>=e.exclusiveMaximum?r:void 0}},...{nullable(e,t,r){if(e.nullable&&null!==t)return r},allOf(e,t,r){for(let i=0;i<e.allOf.length;i++)if(c(e.allOf[i])){if("$validate"in e.allOf[i]){const n=e.allOf[i].$validate(t);if(n)return r.cause=n,r}}else if("boolean"!=typeof e.allOf[i]){if(t!==e.allOf[i])return r}else if(Boolean(t)!==e.allOf[i])return r},anyOf(e,t,r){for(let r=0;r<e.anyOf.length;r++){if(c(e.anyOf[r])){if("$validate"in e.anyOf[r]){if(!e.anyOf[r].$validate(t))return;continue}return}if("boolean"==typeof e.anyOf[r]&&Boolean(t)===e.anyOf[r])return;if(t===e.anyOf[r])return}return r},oneOf(e,t,r){let i=0;for(let r=0;r<e.oneOf.length;r++)if(c(e.oneOf[r])){if("$validate"in e.oneOf[r]){e.oneOf[r].$validate(t)||i++;continue}i++}else"boolean"!=typeof e.oneOf[r]?t===e.oneOf[r]&&i++:Boolean(t)===e.oneOf[r]&&i++;if(1!==i)return r},dependencies(e,t,r){if(c(t))for(const i in e.dependencies){if(i in t==!1)continue;const n=e.dependencies[i];if(Array.isArray(n)){for(let e=0;e<n.length;e++)if(!(n[e]in t))return r.item=e,r;continue}if("boolean"==typeof n){if(n)continue;return r}if("string"==typeof n){if(n in t)continue;return r}const o=n.$validate(t);if(o)return r.cause=o,r}},const(e,t,r){if(!(t===e.const||c(t)&&c(e.const)&&u(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&u(t,e.const)))return r},if(e,t,r){if("then"in e==!1&&"else"in e==!1)return;if("boolean"==typeof e.if){if(e.if){if(e.then)return e.then.$validate(t)}else if(e.else)return e.else.$validate(t);return}return e.if.$validate(t)?e.else?e.else.$validate(t):void 0:e.then?e.then.$validate(t):void 0},not(e,t,r){if("boolean"==typeof e.not)return e.not?r:void 0;if(c(e.not)){if("$validate"in e.not){return e.not.$validate(t)?void 0:r}return r}return r}}},O={SchemaShield:class{types=new Map;formats=new Map;keywords=new Map;immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(g))this.addType(e,t);for(const[e,t]of Object.entries(b))this.addKeyword(e,t);for(const[e,t]of Object.entries(v))t&&this.addFormat(e,t)}addType(e,t){this.types.set(e,t)}addFormat(e,t){this.formats.set(e,t)}addKeyword(e,t){this.keywords.set(e,t)}compile(e){const t=this.compileSchema(e);if(!t.$validate){if(!1===this.isSchemaLike(e))throw new l("Invalid schema");t.$validate=p("any",()=>{})}const r=e=>{const r=this.immutable?m(e):e,i=t.$validate(r);return{data:r,error:i||null,valid:!i}};return r.compiledSchema=t,r}compileSchema(e){c(e)||(e=!0===e?{anyOf:[{}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const t={},r=new l("Invalid type");r.keyword="type";const i=[];let n="";if("type"in e){const o=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim());for(const e of o){const t=this.types.get(e);t&&(i.push(t),n+=(n?"_OR_":"")+t.name)}const a=i.length;if(0===a)throw r;if(1===a){const e=i[0];t.$validate=p(n,t=>{if(!e(t))return r})}else a>1&&(t.$validate=p(n,e=>{for(let t=0;t<a;t++)if(i[t](e))return;return r}))}for(const r in e){if("type"===r){t.type=e.type;continue}const i=this.keywords.get(r);if(i){const e=new l(`Invalid ${r}`);e.keyword=r;const o=r=>i(t,r,e,this);if(t.$validate){const e=t.$validate;n+=`_AND_${i.name}`,t.$validate=p(n,t=>{const r=e(t);if(r)return r;const i=o(t);return i||void 0})}else n=i.name,t.$validate=p(n,o)}c(e[r])?t[r]=this.compileSchema(e[r]):Array.isArray(e[r])?t[r]=e[r].map((e,t)=>this.isSchemaLike(e)?this.compileSchema(e):e):t[r]=e[r]}return t}isSchemaLike(e){if(c(e)){if("type"in e)return!0;for(let t in e)if(this.keywords.has(t))return!0}return!1}}};"undefined"!=typeof module?module.exports=O:self.SchemaShield=O})();//# sourceMappingURL=index.min.js.map