(()=>{var e,t,r=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,f=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n=/\/\d{1,3}(?=%|$)/,i=/\//,o=/%.*$/,a=/([^0-9a-f:/%])/i,s=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[r,n,i,o,a,s]}},function(){return t||(0,e[o(e)[0]])((t={exports:{}}).exports,t),t.exports}),l=class extends Error{name;pointer;message;value;code;item;constructor(e,t){super(e),this.pointer=t}};function u(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!u(e[r],t[r]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!u(e[n],t[n]))return!1;return!0}return e===t}function m(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=c(e[r]);return t}if(m(e)){const t={};for(const r in e)t[r]=c(e[r]);return t}return e}function p(e){return m(e)&&"$validate"in e}function d(e,t){return Object.defineProperty(t,"name",{value:e})}var y=((e,t,f)=>(f=null!=e?r(a(e)):{},((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let f of o(t))s.call(e,f)||f===r||n(e,f,{get:()=>t[f],enumerable:!(a=i(t,f))||a.enumerable});return e})(!t&&e&&e.__esModule?f:n(f,"default",{value:e,enumerable:!0}),e)))(f()),h={"date-time":/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},v={"date-time"(e){const t=e.toUpperCase();if(!h["date-time"].test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())},uri:e=>h.uri.test(e),email(e){if(!h.email.test(e))return!1;const[t,r]=e.split("@");return!(t.length>64||-1!==t.indexOf("..")||"."===t[0]||"."===t[t.length-1])&&!(r.length>255||-1!==r.indexOf("..")||"."===r[0]||"."===r[r.length-1])},ipv4:(0,y.default)({version:4}),ipv6:(0,y.default)({version:6}),hostname:e=>h.hostname.test(e),date:e=>"string"==typeof e&&(!1!==h.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||h["json-pointer"].test(e),"relative-json-pointer":e=>""===e||h["relative-json-pointer"].test(e),time:e=>h.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},g={object:e=>m(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e},b={...{required(e,t,r){if(m(t))for(let n=0;n<e.required.length;n++){const i=e.required[n];if(!t.hasOwnProperty(i))return r.item=i,r}},properties(e,t,r){if(!m(t))return;const n=Object.keys(e.properties);for(const i of n)if(void 0!==t[i]){if("boolean"!=typeof e.properties[i]){if("$validate"in e.properties[i]){const r=e.properties[i].$validate(t[i]);if(r)return r.item=i,r}}else if(!1===e.properties[i])return r.item=i,r}else{const r=e.properties[i];m(r)&&"default"in r&&(t[i]=r.default)}},maxProperties(e,t,r){if(m(t)&&!(Object.keys(t).length<=e.maxProperties))return r},minProperties(e,t,r){if(m(t)&&!(Object.keys(t).length>=e.minProperties))return r},additionalProperties(e,t,r){if(!m(t))return;const n=Object.keys(t),i=p(e.additionalProperties);for(const o of n)if(!e.properties||!e.properties.hasOwnProperty(o)){if(e.patternProperties){let t=!1;for(const r in e.patternProperties)if(new RegExp(r,"u").test(o)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)return r.item=o,r;if(i){const r=e.additionalProperties.$validate(t[o]);if(r)return r.item=o,r}}},patternProperties(e,t,r){if(!m(t))return;const n=Object.keys(e.patternProperties);for(const i of n){const n=new RegExp(i,"u");if("boolean"==typeof e.patternProperties[i]){if(!1===e.patternProperties[i])for(const e in t)if(n.test(e))return r.item=e,r;continue}const o=Object.keys(t);for(const r of o)if(n.test(r)&&"$validate"in e.patternProperties[i]){const n=e.patternProperties[i].$validate(t[r]);if(n)return n.item=r,n}}},propertyNames(e,t,r){if(m(t)){if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)return r;if(p(e.propertyNames))for(let r in t){const t=e.propertyNames.$validate(r);if(t)return t.item=r,t}}},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,$comment:!1,contentMediaType:!1,contentEncoding:!1},...{items(e,t,r){if(!Array.isArray(t))return;const n=e.items,i=t.length;if("boolean"==typeof n)return!1===n&&i>0?r:void 0;if(Array.isArray(n)){const e=n.length,o=Math.min(e,i);for(let e=0;e<o;e++){const i=n[e];if("boolean"!=typeof i){if(p(i)){const r=i.$validate(t[e]);if(r)return r.item=e,r}}else if(!1===i&&void 0!==t[e])return r.message="Array item is not allowed",r.item=e,r}}else if(p(n))for(let e=0;e<i;e++){const r=n.$validate(t[e]);if(r)return r.item=e,r}},minItems(e,t,r){if(Array.isArray(t)&&!(t.length>=e.minItems))return r},maxItems(e,t,r){if(Array.isArray(t)&&!(t.length<=e.maxItems))return r},additionalItems(e,t,r){if(Array.isArray(t)&&e.items&&Array.isArray(e.items)){if(!1===e.additionalItems)return t.length>e.items.length?r:void 0;if(m(e.additionalItems)){if(p(e.additionalItems)){for(let r=e.items.length;r<t.length;r++){const n=e.additionalItems.$validate(t[r]);if(n)return n.item=r,n}return}}else;}},uniqueItems(e,t,r){if(!Array.isArray(t)||!e.uniqueItems)return;const n=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:m(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),n.has(t))return r;n.add(t)}},contains(e,t,r){if(Array.isArray(t)){if("boolean"==typeof e.contains)return e.contains?0===t.length?r:void 0:r;for(let r=0;r<t.length;r++){if(!e.contains.$validate(t[r]))return}return r}}},...{minLength(e,t,r){if(!("string"!=typeof t||t.length>=e.minLength))return r},maxLength(e,t,r){if(!("string"!=typeof t||t.length<=e.maxLength))return r},pattern(e,t,r){if("string"!=typeof t)return;const n=new RegExp(e.pattern,"u");return n instanceof RegExp==!1?r:n.test(t)?void 0:r},format(e,t,r,n){if("string"!=typeof t)return;const i=n.formats.get(e.format);if(!1!==i){if("function"==typeof i){if(i(t))return;return r}return r}},enum(e,t,r){const n=Array.isArray(t),i="object"==typeof t&&null!==t;for(let r=0;r<e.enum.length;r++){const o=e.enum[r];if(o===t)return;if((n&&Array.isArray(o)||i&&"object"==typeof o&&null!==o)&&u(o,t))return}return r}},...{minimum(e,t,r,n){if("number"!=typeof t)return;let i=e.minimum;return"number"==typeof e.exclusiveMinimum?i=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(i+=1e-15),t<i?r:void 0},maximum(e,t,r,n){if("number"!=typeof t)return;let i=e.maximum;return"number"==typeof e.exclusiveMaximum?i=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(i-=1e-15),t>i?r:void 0},multipleOf(e,t,r,n){if("number"!=typeof t)return;const i=t/e.multipleOf;return isFinite(i)?function(e,t,r=1e-15){return Math.abs(e-t)<=r*Math.max(Math.abs(e),Math.abs(t))}(i,Math.round(i))?void 0:r:void 0},exclusiveMinimum(e,t,r,n){if("number"==typeof t&&"number"==typeof e.exclusiveMinimum&&!("minimum"in e))return t<=e.exclusiveMinimum+1e-15?r:void 0},exclusiveMaximum(e,t,r,n){if("number"==typeof t&&"number"==typeof e.exclusiveMaximum&&!("maximum"in e))return t>=e.exclusiveMaximum?r:void 0}},...{nullable(e,t,r){if(e.nullable&&null!==t)return r},allOf(e,t,r){for(let n=0;n<e.allOf.length;n++)if(m(e.allOf[n])){if("$validate"in e.allOf[n]){const r=e.allOf[n].$validate(t);if(r)return r}}else if("boolean"!=typeof e.allOf[n]){if(t!==e.allOf[n])return r}else if(Boolean(t)!==e.allOf[n])return r},anyOf(e,t,r){for(let r=0;r<e.anyOf.length;r++){if(m(e.anyOf[r])){if("$validate"in e.anyOf[r]){if(!e.anyOf[r].$validate(t))return;continue}return}if("boolean"==typeof e.anyOf[r]&&Boolean(t)===e.anyOf[r])return;if(t===e.anyOf[r])return}return r},oneOf(e,t,r){let n=0;for(let r=0;r<e.oneOf.length;r++)if(m(e.oneOf[r])){if("$validate"in e.oneOf[r]){e.oneOf[r].$validate(t)||n++;continue}n++}else"boolean"!=typeof e.oneOf[r]?t===e.oneOf[r]&&n++:Boolean(t)===e.oneOf[r]&&n++;if(1!==n)return r},dependencies(e,t,r){if(m(t))for(const n in e.dependencies){if(n in t==!1)continue;const i=e.dependencies[n];if(Array.isArray(i)){for(let e=0;e<i.length;e++)if(!(i[e]in t))return r.item=e,r;continue}if("boolean"==typeof i){if(i)continue;return r}if("string"==typeof i){if(i in t)continue;return r}const o=i.$validate(t);if(o)return o}},const(e,t,r){if(!(t===e.const||m(t)&&m(e.const)&&u(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&u(t,e.const)))return r},if(e,t,r){if("then"in e==!1&&"else"in e==!1)return;if("boolean"==typeof e.if){if(e.if){if(e.then)return e.then.$validate(t)}else if(e.else)return e.else.$validate(t);return}return e.if.$validate(t)?e.else?e.else.$validate(t):void 0:e.then?e.then.$validate(t):void 0},not(e,t,r){if("boolean"==typeof e.not)return e.not?r:void 0;if(m(e.not)){if("$validate"in e.not){return e.not.$validate(t)?void 0:r}return r}return r}}},O={SchemaShield:class{types=new Map;formats=new Map;keywords=new Map;immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(g))this.addType(e,t);for(const[e,t]of Object.entries(b))this.addKeyword(e,t);for(const[e,t]of Object.entries(v))t&&this.addFormat(e,t)}addType(e,t){this.types.set(e,t)}addFormat(e,t){this.formats.set(e,t)}addKeyword(e,t){this.keywords.set(e,t)}compile(e){const t=this.compileSchema(e,"#");if(!t.$validate){if(!1===this.isSchemaLike(e))throw new l("Invalid schema","#");t.$validate=d("any",()=>{})}const r=e=>{const r=this.immutable?c(e):e,n=t.$validate(r);return{data:r,error:n||null,valid:!n}};return r.compiledSchema=t,r}compileSchema(e,t){m(e)||(e=!0===e?{anyOf:[{}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const r={},n=new l("Invalid type",t),i=[];let o="";if("type"in e){const t=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim());for(const e of t){const t=this.types.get(e);t&&(i.push(t),o+=(o?"_OR_":"")+t.name)}const a=i.length;if(0===a)throw n;if(1===a){const e=i[0];r.$validate=d(o,t=>{if(!e(t))return n})}else a>1&&(r.$validate=d(o,e=>{for(let t=0;t<a;t++)if(i[t](e))return;return n}))}for(const n in e){if("type"===n){r.type=e.type;continue}const i=this.keywords.get(n);if(i){const e=new l(`Invalid ${n}`,t),a=t=>i(r,t,e,this);if(r.$validate){const e=r.$validate;o+=`_AND_${i.name}`,r.$validate=d(o,t=>{const r=e(t);return r||a(t)})}else o=i.name,r.$validate=d(o,a)}m(e[n])?r[n]=this.compileSchema(e[n],`${t}/${n}`):Array.isArray(e[n])?r[n]=e[n].map((e,r)=>this.isSchemaLike(e)?this.compileSchema(e,`${t}/${n}/${r}`):e):r[n]=e[n]}return r}isSchemaLike(e){if(m(e)){if("type"in e)return!0;for(let t in e)if(this.keywords.has(t))return!0}return!1}}};"undefined"!=typeof module?module.exports=O:self.SchemaShield=O})();//# sourceMappingURL=index.min.js.map