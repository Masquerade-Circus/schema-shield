(()=>{var e,t,r=Object.create,i=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,l=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i=/\/\d{1,3}(?=%|$)/,n=/\//,a=/%.*$/,o=/([^0-9a-f:/%])/i,s=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[r,i,n,a,o,s]}},function(){return t||(0,e[a(e)[0]])((t={exports:{}}).exports,t),t.exports}),u=class extends Error{message;item;keyword;cause;path="";data;schema;_getCause(e="#"){const t=e+"/"+this.keyword+(void 0!==this.item?"/"+this.item:"");return this.cause?this.cause._getCause(t):(this.path=t,this)}getCause(){return this._getCause()}};function f(e,t){const r=new u(`Invalid ${e}`);r.keyword=e,r.schema=t;return y(`defineError_${e}`,(e,t={})=>(r.message=e,r.item=t.item,r.cause=t.cause,r.data=t.data,r))}function d(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!d(e[r],t[r]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const i of r)if(!d(e[i],t[i]))return!1;return!0}return e===t}function m(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=c(e[r]);return t}if(e&&e.constructor&&"Object"!==e.constructor.name)return e;if(m(e)){const t={...e};for(const r in e)t[r]=c(e[r]);return t}return e}function p(e){return m(e)&&"$validate"in e}function y(e,t){return Object.defineProperty(t,"name",{value:e})}var h=((e,t,l)=>(l=null!=e?r(o(e)):{},((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of a(t))s.call(e,l)||l===r||i(e,l,{get:()=>t[l],enumerable:!(o=n(t,l))||o.enumerable});return e})(!t&&e&&e.__esModule?l:i(l,"default",{value:e,enumerable:!0}),e)))(l()),v={time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},g=[31,,31,30,31,30,31,31,30,31,30,31],b={"date-time"(e){const t=e.match(/^(\d{4})-(0[0-9]|1[0-2])-(\d{2})T(0[0-9]|1\d|2[0-3]):([0-5]\d):((?:[0-5]\d|60))(?:.\d+)?(?:([+-])(0[0-9]|1\d|2[0-3]):([0-5]\d)|Z)?$/i);if(!t)return!1;let r=Number(t[3]);if("02"===t[2]&&r>29)return!1;const[,i,n,,a,o,s,l,u,f]=t;let d=Number(i),m=Number(n),c=Number(a),p=Number(o),y=Number(s);if("-"===l||"+"===l){const e=Number(u),t=Number(f);if("-"===l?(c+=e,p+=t):"+"===l&&(c-=e,p-=t),p>59?(c+=1,p-=60):p<0&&(c-=1,p+=60),c>23?(r+=1,c-=24):c<0&&(r-=1,c+=24),r>31?(m+=1,r-=31):r<1&&(m-=1,r+=31),m>12?(d+=1,m-=12):m<1&&(d-=1,m+=12),d<0)return!1}return!(r>(2===m?d%4!=0||d%100==0&&d%400!=0?28:29:g[m-1]))&&(60!==y||59===p&&23===c)},uri:e=>v.uri.test(e),email:e=>/^(?!\.)(?!.*\.$)[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,20}(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]{1,21}){0,2}@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,60}[a-z0-9])?){0,3}$/i.test(e),ipv4:(0,h.default)({version:4}),ipv6:(0,h.default)({version:6}),hostname:e=>v.hostname.test(e),date:e=>"string"==typeof e&&(!1!==v.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||v["json-pointer"].test(e),"relative-json-pointer":e=>""===e||v["relative-json-pointer"].test(e),time:e=>v.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},A={object:e=>m(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e,timestamp:!1,int8:!1,unit8:!1,int16:!1,unit16:!1,int32:!1,unit32:!1,float32:!1,float64:!1},O={...{required(e,t,r){if(m(t))for(let i=0;i<e.required.length;i++){const n=e.required[i];if(!t.hasOwnProperty(n))return r("Required property is missing",{item:n,data:t[n]})}},properties(e,t,r){if(m(t))for(const i of Object.keys(e.properties))if(t.hasOwnProperty(i)){if("boolean"!=typeof e.properties[i]){if("$validate"in e.properties[i]){const n=e.properties[i].$validate(t[i]);if(n)return r("Property is invalid",{item:i,cause:n,data:t[i]})}}else if(!1===e.properties[i])return r("Property is not allowed",{item:i,data:t[i]})}else{const r=e.properties[i];m(r)&&"default"in r&&(t[i]=r.default)}},values(e,t,r){if(!m(t)||!p(e.values))return;const i=Object.keys(t);for(const n of i){const i=e.values.$validate(t[n]);if(i)return r("Property is invalid",{item:n,cause:i,data:t[n]})}},maxProperties(e,t,r){if(m(t)&&!(Object.keys(t).length<=e.maxProperties))return r("Too many properties",{data:t})},minProperties(e,t,r){if(m(t)&&!(Object.keys(t).length>=e.minProperties))return r("Too few properties",{data:t})},additionalProperties(e,t,r){if(!m(t))return;const i=Object.keys(t),n=p(e.additionalProperties);for(const a of i)if(!e.properties||!e.properties.hasOwnProperty(a)){if(e.patternProperties){let t=!1;for(const r in e.patternProperties)if(new RegExp(r,"u").test(a)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)return r("Additional properties are not allowed",{item:a,data:t[a]});if(n){const i=e.additionalProperties.$validate(t[a]);if(i)return r("Additional properties are invalid",{item:a,cause:i,data:t[a]})}}},patternProperties(e,t,r){if(!m(t))return;const i=Object.keys(e.patternProperties);for(const n of i){const i=new RegExp(n,"u");if("boolean"==typeof e.patternProperties[n]){if(!1===e.patternProperties[n])for(const e in t)if(i.test(e))return r("Property is not allowed",{item:e,data:t[e]});continue}const a=Object.keys(t);for(const o of a)if(i.test(o)&&"$validate"in e.patternProperties[n]){const i=e.patternProperties[n].$validate(t[o]);if(i)return r("Property is invalid",{item:o,cause:i,data:t[o]})}}},propertyNames(e,t,r){if(m(t)){if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)return r("Properties are not allowed",{data:t});if(p(e.propertyNames))for(let i in t){const n=e.propertyNames.$validate(i);if(n)return r("Property name is invalid",{item:i,cause:n,data:t[i]})}}},dependencies(e,t,r){if(m(t))for(const i in e.dependencies){if(i in t==!1)continue;const n=e.dependencies[i];if(Array.isArray(n)){for(let e=0;e<n.length;e++)if(!(n[e]in t))return r("Dependency is not satisfied",{item:e,data:n[e]});continue}if("boolean"==typeof n){if(n)continue;return r("Dependency is not satisfied",{data:n})}if("string"==typeof n){if(n in t)continue;return r("Dependency is not satisfied",{data:n})}const a=n.$validate(t);if(a)return r("Dependency is not satisfied",{cause:a,data:t})}},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,description:!1,$comment:!1,examples:!1,contentMediaType:!1,contentEncoding:!1,discriminator:!1,nullable:!1},...{items(e,t,r){if(!Array.isArray(t))return;const i=e.items,n=t.length;if("boolean"==typeof i)return!1===i&&n>0?r("Array items are not allowed",{data:t}):void 0;if(Array.isArray(i)){const e=i.length,a=Math.min(e,n);for(let e=0;e<a;e++){const n=i[e];if("boolean"!=typeof n){if(p(n)){const i=n.$validate(t[e]);if(i)return r("Array item is invalid",{item:e,cause:i,data:t[e]})}}else if(!1===n&&void 0!==t[e])return r("Array item is not allowed",{item:e,data:t[e]})}}else if(p(i))for(let e=0;e<n;e++){const n=i.$validate(t[e]);if(n)return r("Array item is invalid",{item:e,cause:n,data:t[e]})}},elements(e,t,r){if(Array.isArray(t)&&p(e.elements))for(let i=0;i<t.length;i++){const n=e.elements.$validate(t[i]);if(n)return r("Array item is invalid",{item:i,cause:n,data:t[i]})}},minItems(e,t,r){if(Array.isArray(t)&&!(t.length>=e.minItems))return r("Array is too short",{data:t})},maxItems(e,t,r){if(Array.isArray(t)&&!(t.length<=e.maxItems))return r("Array is too long",{data:t})},additionalItems(e,t,r){if(Array.isArray(t)&&e.items&&Array.isArray(e.items)){if(!1===e.additionalItems)return t.length>e.items.length?r("Array is too long",{data:t}):void 0;if(m(e.additionalItems)){if(p(e.additionalItems)){for(let i=e.items.length;i<t.length;i++){const n=e.additionalItems.$validate(t[i]);if(n)return r("Array item is invalid",{item:i,cause:n,data:t[i]})}return}}else;}},uniqueItems(e,t,r){if(!Array.isArray(t)||!e.uniqueItems)return;const i=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:m(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),i.has(t))return r("Array items are not unique",{data:e});i.add(t)}},contains(e,t,r){if(Array.isArray(t)){if("boolean"==typeof e.contains)return e.contains?0===t.length?r("Array must contain at least one item",{data:t}):void 0:r("Array must not contain any items",{data:t});for(let r=0;r<t.length;r++){if(!e.contains.$validate(t[r]))return}return r("Array must contain at least one item",{data:t})}}},...{minLength(e,t,r){if(!("string"!=typeof t||t.length>=e.minLength))return r("Value is shorter than the minimum length",{data:t})},maxLength(e,t,r){if(!("string"!=typeof t||t.length<=e.maxLength))return r("Value is longer than the maximum length",{data:t})},pattern(e,t,r){if("string"!=typeof t)return;const i=new RegExp(e.pattern,"u");return i instanceof RegExp==!1?r("Invalid regular expression",{data:t}):i.test(t)?void 0:r("Value does not match the pattern",{data:t})},format(e,t,r,i){if("string"!=typeof t)return;const n=i.getFormat(e.format);if(!1!==n){if(n){if(n(t))return;return r("Value does not match the format",{data:t})}return r("Format is not supported",{data:t})}}},...{minimum(e,t,r,i){if("number"!=typeof t)return;let n=e.minimum;return"number"==typeof e.exclusiveMinimum?n=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(n+=1e-15),t<n?r("Value is less than the minimum",{data:t}):void 0},maximum(e,t,r,i){if("number"!=typeof t)return;let n=e.maximum;return"number"==typeof e.exclusiveMaximum?n=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(n-=1e-15),t>n?r("Value is greater than the maximum",{data:t}):void 0},multipleOf(e,t,r,i){if("number"!=typeof t)return;const n=t/e.multipleOf;return isFinite(n)?function(e,t,r=1e-15){return Math.abs(e-t)<=r*Math.max(Math.abs(e),Math.abs(t))}(n,Math.round(n))?void 0:r("Value is not a multiple of the multipleOf",{data:t}):void 0},exclusiveMinimum(e,t,r,i){if("number"==typeof t&&"number"==typeof e.exclusiveMinimum&&!("minimum"in e))return t<=e.exclusiveMinimum+1e-15?r("Value is less than or equal to the exclusiveMinimum"):void 0},exclusiveMaximum(e,t,r,i){if("number"==typeof t&&"number"==typeof e.exclusiveMaximum&&!("maximum"in e))return t>=e.exclusiveMaximum?r("Value is greater than or equal to the exclusiveMaximum",{data:t}):void 0}},...{enum(e,t,r){const i=Array.isArray(t),n="object"==typeof t&&null!==t;for(let r=0;r<e.enum.length;r++){const a=e.enum[r];if(a===t)return;if((i&&Array.isArray(a)||n&&"object"==typeof a&&null!==a)&&d(a,t))return}return r("Value is not one of the allowed values",{data:t})},allOf(e,t,r){for(let i=0;i<e.allOf.length;i++)if(m(e.allOf[i])){if("$validate"in e.allOf[i]){const n=e.allOf[i].$validate(t);if(n)return r("Value is not valid",{cause:n,data:t})}}else if("boolean"!=typeof e.allOf[i]){if(t!==e.allOf[i])return r("Value is not valid",{data:t})}else if(Boolean(t)!==e.allOf[i])return r("Value is not valid",{data:t})},anyOf(e,t,r){for(let r=0;r<e.anyOf.length;r++){if(m(e.anyOf[r])){if("$validate"in e.anyOf[r]){if(!e.anyOf[r].$validate(t))return;continue}return}if("boolean"==typeof e.anyOf[r]&&Boolean(t)===e.anyOf[r])return;if(t===e.anyOf[r])return}return r("Value is not valid",{data:t})},oneOf(e,t,r){let i=0;for(let r=0;r<e.oneOf.length;r++)if(m(e.oneOf[r])){if("$validate"in e.oneOf[r]){e.oneOf[r].$validate(t)||i++;continue}i++}else"boolean"!=typeof e.oneOf[r]?t===e.oneOf[r]&&i++:Boolean(t)===e.oneOf[r]&&i++;if(1!==i)return r("Value is not valid",{data:t})},const(e,t,r){if(!(t===e.const||m(t)&&m(e.const)&&d(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&d(t,e.const)))return r("Value is not valid",{data:t})},if(e,t,r){if("then"in e==!1&&"else"in e==!1)return;if("boolean"==typeof e.if){if(e.if){if(p(e.then))return e.then.$validate(t)}else if(p(e.else))return e.else.$validate(t);return}if(!p(e.if))return;return e.if.$validate(t)?p(e.else)?e.else.$validate(t):void 0:p(e.then)?e.then.$validate(t):void 0},not(e,t,r){if("boolean"==typeof e.not)return e.not?r("Value is not valid",{data:t}):void 0;if(m(e.not)){if("$validate"in e.not){const i=e.not.$validate(t);return i?void 0:r("Value is not valid",{cause:i,data:t})}return r("Value is not valid",{data:t})}return r("Value is not valid",{data:t})}}},$={SchemaShield:class{types={};formats={};keywords={};immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(A))t&&this.addType(e,t);for(const[e,t]of Object.entries(O))this.addKeyword(e,t);for(const[e,t]of Object.entries(b))t&&this.addFormat(e,t)}addType(e,t,r=!1){if(this.types[e]&&!r)throw new u(`Type "${e}" already exists`);this.types[e]=t}getType(e){return this.types[e]}addFormat(e,t,r=!1){if(this.formats[e]&&!r)throw new u(`Format "${e}" already exists`);this.formats[e]=t}getFormat(e){return this.formats[e]}addKeyword(e,t,r=!1){if(this.keywords[e]&&!r)throw new u(`Keyword "${e}" already exists`);this.keywords[e]=t}getKeyword(e){return this.keywords[e]}compile(e){const t=this.compileSchema(e);if(!t.$validate){if(!1===this.isSchemaLike(e))throw new u("Invalid schema");t.$validate=y("any",()=>{})}const r=e=>{const r=this.immutable?c(e):e,i=t.$validate(r);return{data:r,error:i||null,valid:!i}};return r.compiledSchema=t,r}compileSchema(e){m(e)||(e=!0===e?{anyOf:[{}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const t={...e},r=f("type",e),i=[];let n="";if("type"in e){const a=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim());for(const e of a){const t=this.getType(e);t&&(i.push(t),n+=(n?"_OR_":"")+t.name)}const o=i.length;if(0===o)throw r("Invalid type for schema",{data:e.type});if(1===o){const e=i[0];t.$validate=y(n,t=>{if(!e(t))return r("Invalid type",{data:t})})}else o>1&&(t.$validate=y(n,e=>{for(let t=0;t<o;t++)if(i[t](e))return;return r("Invalid type",{data:e})}))}for(const r of Object.keys(e)){if("type"===r){t.type=e.type;continue}const i=this.getKeyword(r);if(i){const a=f(r,e[r]),o=e=>i(t,e,a,this);if(t.$validate){const e=t.$validate;n+=`_AND_${i.name}`,t.$validate=y(n,t=>{const r=e(t);if(r)return r;const i=o(t);return i||void 0})}else n=i.name,t.$validate=y(n,o)}m(e[r])?t[r]=this.compileSchema(e[r]):Array.isArray(e[r])?t[r]=e[r].map((e,t)=>this.isSchemaLike(e)?this.compileSchema(e):e):t[r]=e[r]}return t}isSchemaLike(e){if(m(e)){if("type"in e)return!0;for(let t in e)if(t in this.keywords)return!0}return!1}}};"undefined"!=typeof module?module.exports=$:self.SchemaShield=$})();//# sourceMappingURL=index.min.js.map