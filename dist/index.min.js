(()=>{var e,t,r=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.getPrototypeOf,s=Object.prototype.hasOwnProperty,f=(e={"node_modules/is-my-ip-valid/index.js"(e,t){var r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n=/\/\d{1,3}(?=%|$)/,i=/\//,o=/%.*$/,a=/([^0-9a-f:/%])/i,s=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/i;t.exports.__all_regexes__=[r,n,i,o,a,s]}},function(){return t||(0,e[o(e)[0]])((t={exports:{}}).exports,t),t.exports}),l=class extends Error{name;pointer;message;value;code;item;constructor(e,t){super(e),this.pointer=t}};function u(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!u(e[r],t[r]))return!1;return!0}if("object"==typeof e&&"object"==typeof t){if(null===e||null===t)return e===t;const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!u(e[n],t[n]))return!1;return!0}return e===t}function m(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function c(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=c(e[r]);return t}if(m(e)){const t={};for(const r in e)t[r]=c(e[r]);return t}return e}function p(e){return m(e)&&"$validate"in e}function h(e,t){return Object.defineProperty(t,"name",{value:e})}var y=((e,t,f)=>(f=null!=e?r(a(e)):{},((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let f of o(t))s.call(e,f)||f===r||n(e,f,{get:()=>t[f],enumerable:!(a=i(t,f))||a.enumerable});return e})(!t&&e&&e.__esModule?f:n(f,"default",{value:e,enumerable:!0}),e)))(f()),d={"date-time":/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,time:/^(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|([+-])(\d{2}):(\d{2}))$/,uri:/^[a-zA-Z][a-zA-Z0-9+\-.]*:[^\s]*$/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,hostname:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,62}(\.[a-zA-Z0-9][a-zA-Z0-9-]{0,62})*[a-zA-Z0-9]$/,date:/^(\d{4})-(\d{2})-(\d{2})$/,"json-pointer":/^\/(?:[^~]|~0|~1)*$/,"relative-json-pointer":/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/},g={"date-time"(e){const t=e.toUpperCase();if(!d["date-time"].test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())},uri:e=>d.uri.test(e),email(e){if(!d.email.test(e))return!1;const[t,r]=e.split("@");return!(t.length>64||-1!==t.indexOf("..")||"."===t[0]||"."===t[t.length-1])&&!(r.length>255||-1!==r.indexOf("..")||"."===r[0]||"."===r[r.length-1])},ipv4:(0,y.default)({version:4}),ipv6:(0,y.default)({version:6}),hostname:e=>d.hostname.test(e),date:e=>"string"==typeof e&&(!1!==d.date.test(e)&&!isNaN(new Date(e).getTime())),regex(e){try{return new RegExp(e),!0}catch(e){return!1}},"json-pointer":e=>""===e||d["json-pointer"].test(e),"relative-json-pointer":e=>""===e||d["relative-json-pointer"].test(e),time:e=>d.time.test(e),duration:!1,"idn-email":!1,"idn-hostname":!1,uuid:!1,"uri-reference":!1,iri:!1,"iri-reference":!1,"uri-template":!1},b={object:e=>m(e),array:e=>!!Array.isArray(e)||"object"==typeof e&&null!==e&&"length"in e&&"0"in e&&Object.keys(e).length-1===e.length,string:e=>"string"==typeof e,number:e=>"number"==typeof e,integer:e=>"number"==typeof e&&e%1==0,boolean:e=>"boolean"==typeof e,null:e=>null===e},w={...{required(e,t,r){if(!m(t))return t;for(let n=0;n<e.required.length;n++){const i=e.required[n];if(!t.hasOwnProperty(i))throw r.item=i,r}return t},properties(e,t,r){if(!m(t))return t;const n=Object.keys(e.properties);for(const i of n)if(void 0!==t[i]){if("boolean"!=typeof e.properties[i])"$validate"in e.properties[i]&&(t[i]=e.properties[i].$validate(t[i]));else if(!1===e.properties[i])throw r.item=i,r}else{const r=e.properties[i];m(r)&&"default"in r&&(t[i]=r.default)}return t},maxProperties(e,t,r){if(!m(t)||Object.keys(t).length<=e.maxProperties)return t;throw r},minProperties(e,t,r){if(!m(t)||Object.keys(t).length>=e.minProperties)return t;throw r},additionalProperties(e,t,r){if(!m(t))return t;const n=Object.keys(t),i=p(e.additionalProperties);for(const o of n)if(!e.properties||!e.properties.hasOwnProperty(o)){if(e.patternProperties){let t=!1;for(const r in e.patternProperties)if(new RegExp(r,"u").test(o)){t=!0;break}if(t)continue}if(!1===e.additionalProperties)throw r.item=o,r;i&&(t[o]=e.additionalProperties.$validate(t[o]))}return t},patternProperties(e,t,r){if(!m(t))return t;const n=Object.keys(e.patternProperties);for(const i of n){const n=new RegExp(i,"u");if("boolean"==typeof e.patternProperties[i]){if(!1===e.patternProperties[i])for(const e in t)if(n.test(e))throw r.item=e,r;continue}const o=Object.keys(t);for(const r of o)n.test(r)&&"$validate"in e.patternProperties[i]&&(t[r]=e.patternProperties[i].$validate(t[r]))}return t},propertyNames(e,t,r){if(!m(t))return t;if("boolean"==typeof e.propertyNames&&!1===e.propertyNames&&Object.keys(t).length>0)throw r;if(p(e.propertyNames))for(let r in t)e.propertyNames.$validate(r);return t},then:!1,else:!1,default:!1,$ref:!1,definitions:!1,$id:!1,$schema:!1,title:!1,$comment:!1,contentMediaType:!1,contentEncoding:!1},...{items(e,t,r){if(!Array.isArray(t))return t;const n=e.items,i=t.length;if("boolean"==typeof n){if(!1===n&&i>0)throw r;return t}if(Array.isArray(n)){const e=n.length,o=Math.min(e,i);for(let e=0;e<o;e++)if("boolean"!=typeof n[e])p(n[e])&&(t[e]=n[e].$validate(t[e]));else if(!1===n[e]&&void 0!==t[e])throw r.message="Array item is not allowed",r.item=e,r;return t}if(p(n))for(let e=0;e<i;e++)t[e]=n.$validate(t[e]);return t},minItems(e,t,r){if(!Array.isArray(t)||t.length>=e.minItems)return t;throw r},maxItems(e,t,r){if(!Array.isArray(t)||t.length<=e.maxItems)return t;throw r},additionalItems(e,t,r){if(!Array.isArray(t)||!e.items||!Array.isArray(e.items))return t;if(!1===e.additionalItems){if(t.length>e.items.length)throw r;return t}if(p(e.additionalItems)){for(let r=e.items.length;r<t.length;r++)t[r]=e.additionalItems.$validate(t[r]);return t}return t},uniqueItems(e,t,r){if(!Array.isArray(t)||!e.uniqueItems)return t;const n=new Set;for(const e of t){let t;if(t="string"==typeof e?`s:${e}`:m(e)?`o:${JSON.stringify(Object.fromEntries(Object.entries(e).sort(([e],[t])=>e.localeCompare(t))))}`:Array.isArray(e)?JSON.stringify(e):String(e),n.has(t))throw r;n.add(t)}return t},contains(e,t,r){if(!Array.isArray(t))return t;if("boolean"==typeof e.contains){if(e.contains){if(0===t.length)throw r;return t}throw r}for(let r=0;r<t.length;r++)try{return t[r]=e.contains.$validate(t[r]),t}catch(e){continue}throw r}},...{minLength(e,t,r){if("string"!=typeof t||t.length>=e.minLength)return t;throw r},maxLength(e,t,r){if("string"!=typeof t||t.length<=e.maxLength)return t;throw r},pattern(e,t,r){if("string"!=typeof t)return t;const n=new RegExp(e.pattern,"u");if(n instanceof RegExp==!1)throw r;if(n.test(t))return t;throw r},format(e,t,r,n){if("string"!=typeof t)return t;const i=n.formats.get(e.format);if(!1===i)return t;if("function"==typeof i){if(i(t))return t;throw r}throw r},enum(e,t,r){const n=Array.isArray(t),i="object"==typeof t&&null!==t;for(let r=0;r<e.enum.length;r++){const o=e.enum[r];if(o===t)return t;if((n&&Array.isArray(o)||i&&"object"==typeof o&&null!==o)&&u(o,t))return t}throw r}},...{minimum(e,t,r){if("number"!=typeof t)return t;let n=e.minimum;if("number"==typeof e.exclusiveMinimum?n=e.exclusiveMinimum+1e-15:!0===e.exclusiveMinimum&&(n+=1e-15),t<n)throw r;return t},maximum(e,t,r){if("number"!=typeof t)return t;let n=e.maximum;if("number"==typeof e.exclusiveMaximum?n=e.exclusiveMaximum-1e-15:!0===e.exclusiveMaximum&&(n-=1e-15),t>n)throw r;return t},multipleOf(e,t,r){if("number"!=typeof t)return t;const n=t/e.multipleOf;if(!isFinite(n))return t;if(!function(e,t,r=1e-15){return Math.abs(e-t)<=r*Math.max(Math.abs(e),Math.abs(t))}(n,Math.round(n)))throw r;return t},exclusiveMinimum(e,t,r){if("number"!=typeof t||"number"!=typeof e.exclusiveMinimum||"minimum"in e)return t;if(t<=e.exclusiveMinimum+1e-15)throw r;return t},exclusiveMaximum(e,t,r){if("number"!=typeof t||"number"!=typeof e.exclusiveMaximum||"maximum"in e)return t;if(t>=e.exclusiveMaximum-1e-15)throw r;return t}},...{nullable(e,t,r){if(e.nullable&&null!==t)throw r;return t},allOf(e,t,r){for(let n=0;n<e.allOf.length;n++)if(m(e.allOf[n]))"$validate"in e.allOf[n]&&(t=e.allOf[n].$validate(t));else if("boolean"!=typeof e.allOf[n]){if(t!==e.allOf[n])throw r}else if(Boolean(t)!==e.allOf[n])throw r;return t},anyOf(e,t,r){for(let r=0;r<e.anyOf.length;r++)if(m(e.anyOf[r]))try{return"$validate"in e.anyOf[r]&&(t=e.anyOf[r].$validate(t)),t}catch(e){continue}else{if("boolean"==typeof e.anyOf[r]&&Boolean(t)===e.anyOf[r])return t;if(t===e.anyOf[r])return t}throw r},oneOf(e,t,r){let n=0;for(let r=0;r<e.oneOf.length;r++)if(m(e.oneOf[r])){if("$validate"in e.oneOf[r]==!1){n++;continue}try{t=e.oneOf[r].$validate(t),n++}catch(e){continue}}else{if("boolean"==typeof e.oneOf[r]){Boolean(t)===e.oneOf[r]&&n++;continue}t===e.oneOf[r]&&n++}if(1===n)return t;throw r},dependencies(e,t,r){if(!m(t))return t;for(const n in e.dependencies){if(n in t==!1)continue;const i=e.dependencies[n];if(Array.isArray(i)){for(let e=0;e<i.length;e++)if(!(i[e]in t))throw r.item=e,r}else{if("boolean"==typeof i){if(i)continue;throw r}if("string"==typeof i){if(i in t)continue;throw r}t=i.$validate(t)}}return t},const(e,t,r){if(t===e.const||m(t)&&m(e.const)&&u(t,e.const)||Array.isArray(t)&&Array.isArray(e.const)&&u(t,e.const))return t;throw r},if(e,t,r){if("then"in e==!1&&"else"in e==!1)return t;if("boolean"==typeof e.if){if(e.if){if(e.then)return e.then.$validate(t)}else if(e.else)return e.else.$validate(t);return t}try{if(t=e.if.$validate(t),e.then)try{return e.then.$validate(t)}catch(e){throw r.message="Value must match then schema if it matches if schema",r}}catch(n){if(n instanceof l==!1||"Value must match then schema if it matches if schema"===n.message)throw n;if(e.else)try{return e.else.$validate(t)}catch(e){throw r.message="Value must match else schema if it does not match if schema",r}}return t},not(e,t,r){if("boolean"==typeof e.not){if(e.not)throw r;return t}try{t=e.not.$validate(t)}catch(e){if(e instanceof l)return t}throw r}}},v={SchemaShield:class{types=new Map;formats=new Map;keywords=new Map;immutable=!1;constructor({immutable:e=!1}={}){this.immutable=e;for(const[e,t]of Object.entries(b))this.addType(e,t);for(const[e,t]of Object.entries(w))this.addKeyword(e,t);for(const[e,t]of Object.entries(g))t&&this.addFormat(e,t)}addType(e,t){this.types.set(e,t)}addFormat(e,t){this.formats.set(e,t)}addKeyword(e,t){this.keywords.set(e,t)}compile(e){const t=this.compileSchema(e,"#");if(!t.$validate){if(!1===this.isSchemaLike(e))throw new l("Invalid schema","#");t.$validate=h("any",e=>e)}const r=e=>(this.immutable&&(e=c(e)),t.$validate(e));return r.compiledSchema=t,r}compileSchema(e,t){m(e)||(e=!0===e?{anyOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array"},{type:"object"},{type:"null"}]}:!1===e?{oneOf:[]}:{oneOf:[e]});const r={};if("type"in e){const n=Array.isArray(e.type)?e.type:e.type.split(",").map(e=>e.trim()),i=[];let o="";for(const e of n){const t=this.types.get(e);t&&(i.push(t),o+=(o?"_OR_":"")+t.name)}const a=new l("Invalid type",t);if(0===i.length)throw a;if(1===i.length){const e=i[0];r.$validate=h(o,t=>{if(e(t))return t;throw a})}else r.$validate=h(o,e=>{for(const t of i)if(t(e))return e;throw a})}for(let n in e){if("type"===n)continue;let i=this.keywords.get(n);if(i){const e=new l(`Invalid ${n}`,t);if(r.$validate){const t=r.$validate,n=`${t.name}_AND_${i.name}`;r.$validate=h(n,n=>(n=t(n),i(r,n,e,this)))}else r.$validate=h(i.name,t=>i(r,t,e,this))}m(e[n])?r[n]=this.compileSchema(e[n],`${t}/${n}`):Array.isArray(e[n])?r[n]=e[n].map((e,r)=>this.isSchemaLike(e)?this.compileSchema(e,`${t}/${n}/${r}`):e):r[n]=e[n]}return r}isSchemaLike(e){if(m(e)){if("type"in e)return!0;for(let t in e)if(this.keywords.has(t))return!0}return!1}}};"undefined"!=typeof module?module.exports=v:self.SchemaShield=v})();//# sourceMappingURL=index.min.js.map